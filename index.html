<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Nasuka Wireless</title>
  <style>
    body {
      margin: 0;
      font-family: sans-serif;
      background-color: #ffffff;
      color: #000000;
      line-height: 1.6;
      font-size: 12.8px;
    }

    header {
      background-color: #f8f8f8;
      padding: 10px 20px;
      text-align: center;
      border-bottom: 1px solid #eee;
      position: relative;
    }

    header h1 {
      margin: 0;
      font-size: 22.4px;
      color: #333;
    }

    header img {
      width: 100%;
      max-height: 150px;
      object-fit: contain;
      display: block;
      margin: 0 auto 10px auto;
    }

    .profile-button {
      position: absolute;
      top: 15px;
      font-size: 24px;
      cursor: pointer;
      color: #007bff;
      text-decoration: none;
      left: 20px;
    }

    .cart-icon {
      position: fixed;
      top: 15px;
      right: 20px;
      font-size: 24px;
      cursor: pointer;
      color: #007bff;
      z-index: 1000;
      background-color: #f8f8f8;
      padding: 5px 10px;
      border-radius: 5px;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    }

    .cart-icon:hover, .profile-button:hover {
      color: #0056b3;
    }

    .cart-count {
      position: absolute;
      top: 0px;
      right: 0px;
      background-color: red;
      color: white;
      border-radius: 50%;
      padding: 2px 6px;
      font-size: 10px;
      line-height: 1;
      text-align: center;
      display: none;
    }

    .cart-popup {
      display: none;
      position: fixed;
      top: 60px;
      right: 20px;
      background-color: white;
      border: 1px solid #ddd;
      border-radius: 8px;
      box-shadow: 0 4px 8px rgba(0,0,0,0.2);
      z-index: 1001;
      width: 300px;
      max-height: 400px;
      overflow-y: auto;
      padding: 15px;
      text-align: left;
    }

    .cart-popup h3 {
      margin-top: 0;
      font-size: 18px;
      border-bottom: 1px solid #eee;
      padding-bottom: 10px;
      margin-bottom: 10px;
    }

    .cart-item {
      display: flex;
      flex-direction: column;
      margin-bottom: 10px;
      padding-bottom: 5px;
      border-bottom: 1px dashed #eee;
    }

    .cart-item:last-child {
      border-bottom: none;
    }

    .cart-item-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 5px;
    }

    .cart-item-name {
      font-weight: bold;
      flex-grow: 1;
    }

    .cart-item-price {
      white-space: nowrap;
    }

    .cart-item-controls {
      display: flex;
      justify-content: flex-end;
      align-items: center;
      margin-top: 5px;
    }

    .cart-item-controls button {
      background-color: #007bff;
      color: #fff;
      border: none;
      padding: 3px 8px;
      border-radius: 4px;
      cursor: pointer;
      font-size: 12px;
      margin: 0 3px;
    }

    .cart-item-controls button:hover {
      background-color: #0056b3;
    }

    .cart-item-controls input {
      width: 30px;
      text-align: center;
      border: 1px solid #ccc;
      border-radius: 4px;
      padding: 3px;
      font-size: 12px;
    }

    .cart-total {
      font-weight: bold;
      margin-top: 10px;
      text-align: right;
    }

    .checkout-button {
      background-color: #007bff;
      color: #fff;
      padding: 10px 15px;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      width: 100%;
      margin-top: 15px;
      font-size: 14px;
      font-weight: bold;
      text-decoration: none;
      display: block;
      text-align: center;
    }

    .checkout-button:hover {
      background-color: #0056b3;
    }

    .grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
      gap: 15px;
      padding: 20px;
      max-width: 1200px;
      margin: 0 auto;
    }

    .item {
      text-align: center;
      border: 1px solid #ddd;
      border-radius: 8px;
      padding: 15px;
      background-color: #fff;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
      display: flex;
      flex-direction: column;
      justify-content: space-between;
    }

    .item a {
        text-decoration: none;
        color: inherit;
    }

    .item img {
      width: 100%;
      height: 150px;
      object-fit: cover;
      border-radius: 8px;
      display: block;
      margin-bottom: 10px;
    }

    .item p {
      margin: 5px 0;
      font-size: 12px;
      font-weight: bold;
      color: #333;
    }

    .item .price {
      font-size: 12.8px;
      color: #007bff;
      margin-top: 10px;
      font-weight: bold;
    }

    .add-to-cart-button {
      display: inline-block;
      background-color: #28a745;
      color: #fff;
      padding: 8px 12px;
      border-radius: 5px;
      text-decoration: none;
      margin-top: 12px;
      transition: background-color 0.3s ease;
      font-size: 11.2px;
      font-weight: bold;
      border: none;
      cursor: pointer;
    }

    .add-to-cart-button:hover {
      background-color: #218838;
    }

    .profile-page {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: #ffffff;
      z-index: 1001;
      overflow-y: auto;
    }

    .profile-page .profile-header {
      background-color: #f8f8f8;
      padding: 10px 20px;
      text-align: center;
      border-bottom: 1px solid #eee;
      position: relative;
    }

    .profile-page .profile-header h1 {
      margin: 0;
      font-size: 22.4px;
      color: #333;
    }

    .profile-page .profile-header img {
      width: 100%;
      max-height: 150px;
      object-fit: contain;
      display: block;
      margin: 0 auto 10px auto;
    }

    .profile-page .close-profile-button {
      position: absolute;
      top: 15px;
      left: 20px;
      font-size: 20px;
      cursor: pointer;
      color: #dc3545;
      text-decoration: none;
      padding: 5px 10px;
      border: 1px solid #dc3545;
      border-radius: 5px;
      background-color: #fff;
      transition: background-color 0.3s ease, color 0.3s ease;
    }

    .profile-page .close-profile-button:hover {
      background-color: #dc3545;
      color: #fff;
    }

    .profile-page .content-section {
        padding: 20px;
        max-width: 800px;
        margin: 20px auto;
        background-color: #fdfdfd;
        border-radius: 8px;
        box-shadow: 0 2px 5px rgba(0,0,0,0.05);
    }

    .profile-page .content-section h2 {
      font-size: 20.8px;
      margin-bottom: 15px;
      color: #333;
      text-align: center;
    }

    .profile-page .profile-form {
        margin-top: 30px;
        border-top: 1px solid #eee;
        padding-top: 20px;
    }

    .profile-form label {
        display: block;
        margin-bottom: 8px;
        font-weight: bold;
    }

    .profile-form input[type="text"],
    .profile-form input[type="tel"],
    .profile-form textarea {
        width: calc(100% - 20px);
        padding: 10px;
        margin-bottom: 15px;
        border: 1px solid #ccc;
        border-radius: 4px;
        box-sizing: border-box;
        font-size: 1em;
    }

    .profile-form textarea {
        resize: vertical;
        min-height: 60px;
    }

    .profile-form button {
        background-color: #6c757d;
        color: white;
        padding: 10px 15px;
        border: none;
        border-radius: 5px;
        cursor: pointer;
        font-size: 1em;
        transition: background-color 0.3s ease;
        width: 100%;
    }

    .profile-form button:hover {
        background-color: #5a6268;
    }

    footer {
        background-color: #333;
        color: #fff;
        text-align: center;
        padding: 20px;
        margin-top: 30px;
        font-size: 11.2px;
    }

    footer .footer-content {
        margin-bottom: 15px;
    }

    footer .footer-content p {
        margin: 5px 0;
    }

    footer .footer-links a {
        color: #fff;
        text-decoration: none;
        margin: 0 10px;
        transition: color 0.3s ease;
    }

    footer .footer-links a:hover {
        color: #007bff;
    }

    .sliding-products-container {
      max-width: 1200px;
      margin: 20px auto 0;
      padding: 0 20px;
      position: relative;
    }

    .sliding-products-header {
        font-size: 1.2em;
        font-weight: bold;
        margin-bottom: 15px;
        color: #333;
        text-align: center;
    }

    .sliding-content-wrapper {
        display: flex;
        overflow-x: hidden;
        padding-bottom: 10px;
    }

    .pinned-sliding-item {
        flex: 0 0 auto;
        width: 100px;
        margin-right: 15px;
        text-align: center;
        border: none;
        border-radius: 8px;
        padding: 10px;
        background-color: #fff;
        display: flex;
        flex-direction: column;
        justify-content: space-between;
        transition: transform 0.3s ease;
    }

    .pinned-sliding-item:hover {
        transform: translateY(-3px);
    }

    .pinned-sliding-item img {
      width: 100%;
      height: 75px;
      object-fit: cover;
      border-radius: 6px;
      display: block;
      margin-bottom: 8px;
    }

    .pinned-sliding-item p {
      margin: 3px 0;
      font-size: 10px;
      font-weight: bold;
      color: #333;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .pinned-sliding-item .price {
      font-size: 10.4px;
      color: #007bff;
      margin-top: 5px;
      font-weight: bold;
    }

    .sliding-products-wrapper {
      display: flex;
      overflow-x: auto;
      -webkit-overflow-scrolling: touch;
      flex-grow: 1;
      scrollbar-width: thin;
      scrollbar-color: #888 #f1f1f1;
    }

    .sliding-products-wrapper::-webkit-scrollbar {
      height: 8px;
    }

    .sliding-products-wrapper::-webkit-scrollbar-track {
      background: #f1f1f1;
      border-radius: 10px;
    }

    .sliding-products-wrapper::-webkit-scrollbar-thumb {
      background: #888;
      border-radius: 10px;
    }

    .sliding-products-wrapper::-webkit-scrollbar-thumb:hover {
      background: #555;
    }

    .sliding-item {
      flex: 0 0 auto;
      width: 100px;
      margin-right: 15px;
      text-align: center;
      border: none;
      border-radius: 8px;
      padding: 10px;
      background-color: #fff;
      display: flex;
      flex-direction: column;
      justify-content: space-between;
      transition: transform 0.3s ease;
    }

    .sliding-item:last-child {
        margin-right: 0;
    }

    .sliding-item:hover {
        transform: translateY(-3px);
    }

    .sliding-item img {
      width: 100%;
      height: 75px;
      object-fit: cover;
      border-radius: 6px;
      display: block;
      margin-bottom: 8px;
    }

    .sliding-item p {
      margin: 3px 0;
      font-size: 10px;
      font-weight: bold;
      color: #333;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .sliding-item .price {
      font-size: 10.4px;
      color: #007bff;
      margin-top: 5px;
      font-weight: bold;
    }

    .gif-container {
        text-align: center;
        margin-top: 30px;
        padding: 0 20px;
        width: 100%; /* Lebar container 100% */
        margin-left: auto;
        margin-right: auto;
    }

    .gif-container img {
        width: 25%; /* Lebar gambar 25% dari container (50% dari 50%) */
        height: auto;
        object-fit: cover;
        aspect-ratio: 3 / 1;
        border-radius: 8px;
        box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        display: block;
        margin: 0 auto;
    }

    @media (max-width: 768px) {
        .grid {
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 10px;
            padding: 15px;
        }

        .item img {
            height: 120px;
        }

        header h1, .profile-page .profile-header h1 {
            font-size: 19.2px;
        }

        .cart-icon {
            top: 10px;
            right: 10px;
            font-size: 20px;
            padding: 3px 8px;
        }

        .cart-count {
            top: -5px;
            right: -5px;
            font-size: 8px;
        }

        .cart-popup {
            width: 90%;
            max-width: 280px;
            top: 50px;
            right: 5%;
        }

        .profile-page .content-section {
            padding: 15px;
            margin: 10px auto;
        }
        .profile-page .content-section h2 {
            font-size: 17.6px;
        }

        .pinned-sliding-item,
        .sliding-item {
            width: 80px;
            margin-right: 10px;
            padding: 8px;
        }
        .pinned-sliding-item img,
        .sliding-item img {
            height: 60px;
        }
        .pinned-sliding-item p,
        .sliding-item p {
            font-size: 9px;
        }
        .pinned-sliding-item .price,
        .sliding-item .price {
            font-size: 9.6px;
        }

        .gif-container {
            margin-top: 20px;
            padding: 0 15px;
        }
        .gif-container img {
            width: 35%; /* Disesuaikan untuk tablet (50% dari 70%) */
        }
    }

    @media (max-width: 480px) {
        .grid {
            grid-template-columns: 1fr 1fr;
            padding: 10px;
        }

        .item img {
            height: 100px;
        }

        .item p {
            font-size: 10.4px;
        }

        .item .price {
            font-size: 11.2px;
        }

        .add-to-cart-button {
            padding: 6.4px 8px;
            font-size: 9.6px;
        }

        header img, .profile-page .profile-header img {
            max-height: 100px;
        }

        header h1, .profile-page .profile-header h1 {
            font-size: 16px;
        }
        .profile-page .close-profile-button {
            font-size: 16px;
            padding: 3px 8px;
        }

        .cart-icon {
            top: 5px;
            right: 5px;
            font-size: 18px;
            padding: 2px 6px;
        }
        .cart-count {
            top: -7px;
            right: -7px;
            font-size: 7px;
        }

        .pinned-sliding-item,
        .sliding-item {
            width: 70px;
            margin-right: 8px;
            padding: 6px;
        }
        .pinned-sliding-item img,
        .sliding-item img {
            height: 50px;
        }
        .pinned-sliding-item p,
        .sliding-item p {
            font-size: 8px;
        }
        .pinned-sliding-item .price,
        .sliding-item .price {
            font-size: 8.8px;
        }

        .gif-container {
            margin-top: 15px;
            padding: 0 10px;
        }
        .gif-container img {
            width: 40%; /* Disesuaikan untuk ponsel (50% dari 80%) */
        }
    }
  </style>
</head>
<body>

  <div id="main-content-view">
    <header>
      <img src="https://nasukafoods.site/image/nasuka-karya.jpg" alt="Logo Nasuka Karya">
      <a href="#" class="profile-button" id="profile-button">&#128100;</a>
    </header>

    <div class="cart-icon" id="cart-icon">&#128722;<span class="cart-count" id="cart-count">0</span></div>
    <div class="cart-popup" id="cart-popup">
      <h3>Keranjang Belanja</h3>
      <div id="cart-items">
        <p>Keranjang kosong.</p>
      </div>
      <div class="cart-total" id="cart-total">Total: Rp 0</div>
      <a href="pembayaran.html" class="checkout-button" id="checkout-button">Checkout</a>
    </div>

    <div class="sliding-products-container">
        <h2 class="sliding-products-header">Produk Unggulan Lainnya</h2>
        <div class="sliding-content-wrapper">
            <div class="pinned-sliding-item">
                <a href="form-pembelian.html?product=booster">
                    <img src="https://nasukafoods.site/image/sosial-media.png" alt="booster sosmed">
                </a>
                <p>booster sosmed</p>
                <p class="price">Rp 500</p>
                <input type="hidden" value="1" class="quantity-input" data-price="500" data-product="booster">
                📍Cibaduyut
                <button class="add-to-cart-button">tambah ke keranjang</button>
            </div>

            <div class="sliding-products-wrapper">
                <div class="sliding-item">
                    <a href="form-pembelian.html?product=gesek_tunai">
                        <img src="https://nasukafoods.site/image/gestun.jpg" alt="Gestun">
                    </a>
                    <p>Gestun</p>
                    <p class="price">Rp 400</p>
                    <input type="hidden" value="1" class="quantity-input" data-price="400" data-product="gesek_tunai">
                    <button class="add-to-cart-button">tambah ke keranjang</button>
                </div>
                <div class="sliding-item">
                    <a href="form-pembelian.html?product=pulsa">
                        <img src="https://nasukafoods.site/image/jual-pulsa.jpg" alt="PULSA">
                    </a>
                    <p>PULSA</p>
                    <p class="price">Rp 700</p>
                    <input type="hidden" value="1" class="quantity-input" data-price="700" data-product="pulsa">
                    <button class="add-to-cart-button">tambah ke keranjang</button>
                </div>
                <div class="sliding-item">
                    <a href="form-pembelian.html?product=twitter_retweets">
                        <img src="https://via.placeholder.com/75x75?text=Twitter+RT" alt="Twitter Retweets">
                    </a>
                    <p>Twitter Retweets</p>
                    <p class="price">Rp 300</p>
                    <input type="hidden" value="1" class="quantity-input" data-price="300" data-product="twitter_retweets">
                    <button class="add-to-cart-button">tambah ke keranjang</button>
                </div>
                <div class="sliding-item">
                    <a href="form-pembelian.html?product=new_product_5">
                        <img src="https://via.placeholder.com/75x75?text=Produk+5" alt="Produk Baru 5">
                    </a>
                    <p>Produk Baru 5</p>
                    <p class="price">Rp 800</p>
                    <input type="hidden" value="1" class="quantity-input" data-price="800" data-product="new_product_5">
                    <button class="add-to-cart-button">tambah ke keranjang</button>
                </div>
                 <div class="sliding-item">
                    <a href="form-pembelian.html?product=new_product_6">
                        <img src="https://via.placeholder.com/75x75?text=Produk+6" alt="Produk Baru 6">
                    </a>
                    <p>Produk Baru 6</p>
                    <p class="price">Rp 900</p>
                    <input type="hidden" value="1" class="quantity-input" data-price="900" data-product="new_product_6">
                    <button class="add-to-cart-button">tambah ke keranjang</button>
                </div>
            </div>
        </div>
    </div>

    <div class="grid">
      <div class="item">
        <a href="form-pembelian.html?product=lacak_lokasi">
          <img src="https://nasukafoods.site/lacak-lokasi.gif" alt="Lacak Lokasi">
        </a>
        <p>GPS NASUKA SERVER</p>
        <p class="price">Pantau orang tersayang melalui nasuka server, Layanan khusus tracking unlimited</p> <input type="hidden" value="1" class="quantity-input" data-price="1000" data-product="lacak_lokasi">
      </div>

      <div class="item">
        <a href="form-pembelian.html?product=CILOK GAJIH">
          <img src="https://nasukafoods.site/paketcilok.jpg" alt="CILOK GAJIH">
        </a>
        <p>CILOK GAJIH</p>
        <p class="price">Rp 900</p>
        <input type="hidden" value="1" class="quantity-input" data-price="900" data-product="CILOK GAJIH">📍 Cibaduyut
        <button class="add-to-cart-button">tambah ke keranjang</button>
      </div>
    </div>

    <div class="gif-container">
      <img src="https://nasukafoods.site/image/special-promo.gif" alt="Promosi">
    </div>

    <div class="grid">
        <div class="item">
            <a href="form-pembelian.html?product=produk_baru_1">
                <img src="https://via.placeholder.com/150x150?text=Produk+Baru+1" alt="Produk Baru 1">
            </a>
            <p>Produk Baru 1</p>
            <p class="price">Rp 1.500</p>
            <input type="hidden" value="1" class="quantity-input" data-price="1500" data-product="produk_baru_1">
            <button class="add-to-cart-button">tambah ke keranjang</button>
        </div>
        <div class="item">
            <a href="form-pembelian.html?product=produk_baru_2">
                <img src="https://via.placeholder.com/150x150?text=Produk+Baru+2" alt="Produk Baru 2">
            </a>
            <p>Produk Baru 2</p>
            <p class="price">Rp 2.500</p>
            <input type="hidden" value="1" class="quantity-input" data-price="2500" data-product="produk_baru_2">
            <button class="add-to-cart-button">tambah ke keranjang</button>
        </div>
        <div class="item">
            <a href="form-pembelian.html?product=produk_baru_3">
                <img src="https://via.placeholder.com/150x150?text=Produk+Baru+3" alt="Produk Baru 3">
            </a>
            <p>Produk Baru 3</p>
            <p class="price">Rp 1.200</p>
            <input type="hidden" value="1" class="quantity-input" data-price="1200" data-product="produk_baru_3">
            <button class="add-to-cart-button">tambah ke keranjang</button>
        </div>
        <div class="item">
            <a href="form-pembelian.html?product=produk_baru_4">
                <img src="https://via.placeholder.com/150x150?text=Produk+Baru+4" alt="Produk Baru 4">
            </a>
            <p>Produk Baru 4</p>
            <p class="price">Rp 3.000</p>
            <input type="hidden" value="1" class="quantity-input" data-price="3000" data-product="produk_baru_4">
            <button class="add-to-cart-button">tambah ke keranjang</button>
        </div>
    </div>
  </div>

  <div class="profile-page" id="profile-page-view">
    <div class="profile-header">
      <img src="https://nasukafoods.site/images/nasuka-karya.jpg" alt="Logo Nasuka Karya">
      <button class="close-profile-button" id="close-profile-button">&#10006; Tutup</button>
      <h1>Profil Saya</h1>
    </div>

    <section class="content-section">
      <h2>Informasi Profil</h2>
      <div class="profile-form">
          <label for="profile_nama">Nama Lengkap:</label>
          <input type="text" id="profile_nama" name="profile_nama" required>

          <label for="profile_handphone">Nomor Handphone (WhatsApp):</label>
          <input type="tel" id="profile_handphone" name="profile_handphone" pattern="[0-9]{10,15}" title="Masukkan nomor telepon yang valid (10-15 digit)" required>

          <label for="profile_alamat">Alamat Lengkap:</label>
          <textarea id="profile_alamat" name="profile_alamat" rows="4" required></textarea>

          <label for="profile_username">Username (Contoh: TikTok, Instagram, dll.):</label>
          <input type="text" id="profile_username" name="profile_username" placeholder="@usernameAnda" required>

          <button id="saveProfileBtn">Simpan</button>
      </div>
    </section>
  </div>

  <footer>
    <div class="footer-content">
    </div>
    <div class="footer-links">
      <a href="faq.html">FAQ</a> |
      <a href="refund-policy.html">Policy</a> |
      <a href="terms-conditions.html">Term & Condition</a>
    </div>
    <p>&copy; 2025 Nasuka Karya. Hak Cipta Dilindungi Undang-Undang.</p>
  </footer>

  <script>
    let cart = [];
    const GAS_URL = "https://script.google.com/macros/s/AKfycbxSTsv1cqsJISjB8Pl7rohtzmtoQKuByT73fcFlADQqjTA7dtYVd1_6AWnAhT0x6XqijA/exec";

    document.addEventListener('DOMContentLoaded', () => {
      const mainContentView = document.getElementById('main-content-view');
      const cartIcon = document.getElementById('cart-icon');
      const cartPopup = document.getElementById('cart-popup');
      const cartItemsContainer = document.getElementById('cart-items');
      const cartTotalElement = document.getElementById('cart-total');
      const cartCountElement = document.getElementById('cart-count');
      const checkoutButton = document.getElementById('checkout-button');

      const profileButton = document.getElementById('profile-button');
      const profilePageView = document.getElementById('profile-page-view');
      const closeProfileButton = document.getElementById('close-profile-button');
      const profileNama = document.getElementById('profile_nama');
      const profileHandphone = document.getElementById('profile_handphone');
      const profileAlamat = document.getElementById('profile_alamat');
      const profileUsername = document.getElementById('profile_username');
      const saveProfileBtn = document.getElementById('saveProfileBtn');

      if (localStorage.getItem('nasukaCart')) {
        cart = JSON.parse(localStorage.getItem('nasukaCart'));
        updateCartDisplay();
      }

      const addToCartButtons = document.querySelectorAll('.add-to-cart-button');
      addToCartButtons.forEach(button => {
        button.addEventListener('click', (event) => {
          const item = event.target.closest('.item') || event.target.closest('.sliding-item') || event.target.closest('.pinned-sliding-item');
          
          if (!item) {
              console.error("Could not find parent item for add-to-cart button.");
              return;
          }

          const productName = item.querySelector('p').innerText;
          const quantityInput = item.querySelector('.quantity-input');
          const quantity = parseInt(quantityInput.value);
          const pricePerUnit = parseInt(quantityInput.dataset.price);
          const productCode = quantityInput.dataset.product;

          const existingItemIndex = cart.findIndex(cartItem => cartItem.productCode === productCode);

          if (existingItemIndex > -1) {
            cart[existingItemIndex].quantity += quantity;
            cart[existingItemIndex].totalPrice = cart[existingItemIndex].quantity * cart[existingItemIndex].pricePerUnit;
          } else {
            cart.push({
              productName,
              quantity,
              pricePerUnit,
              totalPrice: quantity * pricePerUnit,
              productCode
            });
          }

          localStorage.setItem('nasukaCart', JSON.stringify(cart));
          updateCartDisplay();
        });
      });

      cartIcon.addEventListener('click', (event) => {
        event.stopPropagation();
        cartPopup.style.display = cartPopup.style.display === 'block' ? 'none' : 'block';
      });

      window.addEventListener('click', (event) => {
        if (!cartPopup.contains(event.target) && !cartIcon.contains(event.target)) {
          cartPopup.style.display = 'none';
        }
      });

      checkoutButton.addEventListener('click', (event) => {
        if (cart.length === 0) {
          alert('Keranjang belanja Anda kosong. Silakan tambahkan produk terlebih dahulu.');
          event.preventDefault();
          return;
        }
      });

      function updateCartDisplay() {
        cartItemsContainer.innerHTML = '';
        let overallTotal = 0;
        let totalItemsInCart = 0;

        if (cart.length === 0) {
          cartItemsContainer.innerHTML = '<p>Keranjang kosong.</p>';
          cartCountElement.style.display = 'none';
          checkoutButton.style.display = 'none';
        } else {
          cart.forEach((item, index) => {
            const cartItemDiv = document.createElement('div');
            cartItemDiv.classList.add('cart-item');
            cartItemDiv.innerHTML = `
              <div class="cart-item-header">
                <div class="cart-item-name">${item.productName}</div>
                <div class="cart-item-price">Rp ${item.totalPrice.toLocaleString('id-ID')}</div>
              </div>
              <div class="cart-item-controls">
                <button class="minus-cart-item" data-index="${index}">-</button>
                <input type="text" value="${item.quantity}" class="cart-quantity-input" data-index="${index}" readonly>
                <button class="plus-cart-item" data-index="${index}">+</button>
              </div>
            `;
            cartItemsContainer.appendChild(cartItemDiv);
            overallTotal += item.totalPrice;
            totalItemsInCart += item.quantity;
          });

          document.querySelectorAll('.minus-cart-item').forEach(button => {
            button.addEventListener('click', (event) => {
              event.stopPropagation();
              const index = parseInt(event.target.dataset.index);
              if (cart[index].quantity > 1) {
                cart[index].quantity--;
                cart[index].totalPrice = cart[index].quantity * cart[index].pricePerUnit;
              } else {
                cart.splice(index, 1);
              }
              localStorage.setItem('nasukaCart', JSON.stringify(cart));
              updateCartDisplay();
            });
          });

          document.querySelectorAll('.plus-cart-item').forEach(button => {
            button.addEventListener('click', (event) => {
              event.stopPropagation();
              const index = parseInt(event.target.dataset.index);
              cart[index].quantity++;
              cart[index].totalPrice = cart[index].quantity * cart[index].pricePerUnit;
              localStorage.setItem('nasukaCart', JSON.stringify(cart));
              updateCartDisplay();
            });
          });

          cartCountElement.innerText = totalItemsInCart;
          cartCountElement.style.display = 'block';
          checkoutButton.style.display = 'block';
        }
        cartTotalElement.innerText = `Total: Rp ${overallTotal.toLocaleString('id-ID')}`;
      }

      profileButton.addEventListener('click', (event) => {
        event.preventDefault();
        mainContentView.style.display = 'none';
        profilePageView.style.display = 'block';
        loadCustomerProfile();
        cartPopup.style.display = 'none';
      });

      closeProfileButton.addEventListener('click', () => {
        profilePageView.style.display = 'none';
        mainContentView.style.display = 'block';
      });

      saveProfileBtn.addEventListener('click', () => {
          saveCustomerProfile();
          alert('Data diri Anda telah disimpan!');
      });

      function loadCustomerProfile() {
          const storedCustomerData = localStorage.getItem('nasukaCustomerData');
          if (storedCustomerData) {
              const customerData = JSON.parse(storedCustomerData);
              profileNama.value = customerData.nama || '';
              profileHandphone.value = customerData.handphone || '';
              profileAlamat.value = customerData.alamat || '';
              profileUsername.value = customerData.username || '';
          }
      }

      function saveCustomerProfile() {
          const customerData = {
              nama: profileNama.value,
              handphone: profileHandphone.value,
              alamat: profileAlamat.value,
              username: profileUsername.value
          };
          localStorage.setItem('nasukaCustomerData', JSON.stringify(customerData));
      }
    });
  </script>
</body>
</html>
