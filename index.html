<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Nasuka</title>
  <style>
    body {
      margin: 0;
      font-family: sans-serif;
      background-color: #fefefe;
      color: white;
      padding-bottom: 60px;
    }
    #profilLink {
      display: none;
    }
    .hero-section {
      position: relative;
      height: 15vh;
      overflow: hidden;
      display: flex;
      flex-direction: column;
      justify-content: space-between;
    }
    #toa-display-area {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  z-index: 5;
  padding: 5px 0;
  box-sizing: border-box;
  background-color: transparent);
  color: white;
  text-shadow: 0 0 3px black;
}

.toa-marquee-container {
  width: 100%;
  overflow: hidden;
  white-space: nowrap;
  box-sizing: border-box;
  position: relative;
}

.toa-marquee-text {
  display: inline-block;
  padding-left: 100%;
  animation: scroll-kiri 15s linear infinite;
  font-weight: bold;
  font-size: 16px;
}

    
  
    .hero-section video,
    .hero-section img {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      object-fit: cover;
      z-index: 0;
    }
    .promo-text,
    .info,
    .sidebar {
      position: relative;
      z-index: 1;
    }
    .promo-text {
      text-align: center;
      margin-top: 5vh;
      font-size: 24px;
      font-weight: bold;
      text-shadow: 0 0 6px black;
      padding: 0 20px;
    }
    .info,
    .sidebar {
      position: absolute;
      bottom: 5px;
    }
    .info {
      left: 6px;
    }
    .info .username {
      font-size: 14px;
      margin-top: 5px;
    }
    .info .balance {
      font-size: 17px;
      color: white;
    }

    .product-section {
      display: flex;
      overflow-x: auto;
      padding: 20px 2px;
      gap: 10px;
      scroll-behavior: smooth;
    }
    .product-section::-webkit-scrollbar {
      display: none;
    }
    .product {
      flex: 0 0 auto;
      width: 90px;
      margin: 0;
      padding: 0;
      background: none !important;
      border: none !important;
      box-shadow: none !important;
      text-align: center;
      color: black;
    }
    .product.sticky-susu {
      position: sticky;
      left: 0;
      background: none !important;
      border: none !important;
      z-index: 10;
    }
    .product img {
      width: 100%;
      aspect-ratio: 1/1;
      object-fit: cover;
      border: none !important;
      box-shadow: none !important;
      background: none !important;
    }
    .product h4,
    .product p {
      margin: 0;
      padding: 0;
      background: none !important;
      border: none !important;
    }
    .marquee {
      width: 100%;
      overflow: hidden;
      white-space: nowrap;
      box-sizing: border-box;
      color: redll;
      padding: 10px 0;
      position: relative;
    }
    .marquee span {
      display: inline-block;
      padding-left: 100%;
      animation: scroll-kiri 10s linear infinite;
    }
    @keyframes scroll-kiri {
      0% { transform: translateX(0); }
      100% { transform: translateX(-100%); }
    }
    .glow-wrapper {
      animation: blingBling 1.5s infinite alternate;
      padding: 5px;
      background: black;
      border-radius: 10px;
      position: relative;
    }
    @keyframes blingBling {
      0% {
        box-shadow: 0 0 10px silver, 0 0 20px blue, 0 0 30px blue;
        transform: scale(1);
      }
      50% {
        box-shadow: 0 0 15px grey, 0 0 25px grey, 0 0 35px grey;
        transform: scale(1);
      }    
      100% {
        box-shadow: 0 0 10px silver, 0 0 20px silver, 0 0 30px silver;
        transform: scale(1);
      }
    }
    .glow-wrapper .glow-text {
      position: absolute;
      bottom: 5px;
      left: 5px;
      color: #fff;
      font-weight: bold;
      font-size: 12px;
      text-shadow: 0 0 5px #0ff, 0 0 10px #0ff, 0 0 20px #0ff;
      background-color: rgba(0, 0, 0, 0.4);
      padding: 2px 6px;
      border-radius: 5px;
      z-index: 2;
    }
    nav {
      
      color: red;
      display: flex;
      justify-content: space-around;
      align-items: center;
      padding: 10px;
      position: fixed;
      bottom: 0;
      left: 0;
      right: 0;
      z-index: 99;
    }
    nav button {
      background: #444;
      border: none;
      color: white;
      padding: 8px 12px;
      border-radius: 5px;
      cursor: pointer;
    }
    nav button:hover {
      background: #777;
    }
    
    
    .large-product-grid {
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: 10px;
  padding: 10px;
}

.large-product {
  background: #fff;
  border-radius: 10px;
  text-align: center;
  color: black;
  width: 100%;
}

.large-product img {
  width: 100%;
  height: auto;
  aspect-ratio: 1/1;
  object-fit: cover;
  border-radius: 10px 10px 0 0;
}
.large-product h4, .large-product p {
  margin: 5px 0;
}
    .online-box {
  position: absolute;
  bottom: 5px;
  right: 6px;
  text-align: right;
  z-index: 2;
  font-size: 13px;
  color: white;
  text-shadow: 0 0 3px black;
}
#online-status {
  font-weight: bold;
}
#onlineCount {
  font-weight: normal;
  font-size: 12px;
  color: lightgray;
}
    
  </style>
</head>
<body>


<div id="toa-display-area" style="text-align: center; padding: 10px;  margin-top: 0.10px;">
    <div class="toa-marquee-container">
        <span class="toa-marquee-text"></span>
    </div>
</div>


<section class="hero-section">

    
    

<div id="toa-display-area" style="text-align: center; padding: 10px;  margin-top: 2px;">
    <div class="toa-marquee-container">
        <span class="toa-marquee-text"></span>
    </div>
</div>

  <img src="https://nasukafoods.site/tekn.jpg" alt="Hero Background">
  <div class="info">
    <div class="username" id="nama"></div>
    <div class="balance" id="saldo">üíµ </div>
  </div>
  
  <div class="online-box">
  <div id="online-status">Transaksi Terbaru (...)</div>
  <div id="onlineCount">0 pengguna online</div>
</div>
  
  
</section>




<section class="product-section">
  <div class="product sticky-susu">
    <div class="marquee" style="position: absolute; top: 0; left: 0; z-index: 10; color: white; font-size: 15px;">
      <span><strong>üéÅ Beli Produk Digital Sekarang! Booster 1.K Likes Cuma 5.000 üéÅ</strong></span>
    </div>
    <div class="glow-wrapper">
      <img src="https://nasukafoods.site/tekn.jpg" alt="Sosmed"
        onclick="goToPayment('', 12000, 'digital')"          
        style="width: 100%; display: block;">
      <div class="glow-text">Booster‚ú®</div>
    </div>
  </div>

  <div class="product">
    <img src="https://nasukafoods.site/susubendera.jpg" alt="Susu" onclick="goToDeskripsi('Susu Bendera', 16500)">
    <h4>Susu</h4>
    <p>Rp 16.500</p>
    <div class="button-frame"><button onclick="goToPayment('Susu Bendera', 16500, 'fisik')">Beli Sekarang</button></div>
  </div>

  <div class="product">
    <img src="https://nasukafoods.site/paketcilok.jpg" alt="Udud" onclick="goToDeskripsi('Udud Armor', 10000)">
    <h4>Paket Cilok</h4>
    <p>Rp 10.000</p>
    <div class="button-frame"><button onclick="goToPayment('Udud Armor', 10000, 'fisik')">Beli Sekarang</button></div>
  </div>

  <div class="product">
    <img src="https://nasukafoods.site/armour.jpg" alt="Udud" onclick="goToDeskripsi('Udud Armor', 10000)">
    <h4>Udud Armor</h4>
    <p>Rp 10.000</p>
    <div class="button-frame"><button onclick="goToPayment('Udud Armor', 10000, 'fisik')">Beli Sekarang</button></div>
  </div>

  <div class="product">
    <img src="https://nasukafoods.site/nasukafoods.jpg" alt="Udud" onclick="goToDeskripsi('Udud Armor', 10000)">
    <h4>Nash</h4>
    <p>Rp 10.000</p>
    <div class="button-frame"><button onclick="goToPayment('Udud Armor', 10000, 'fisik')">Beli Sekarang</button></div>
  </div>
  
  
  
  
</section>
</section> 







 
















<div class="large-product-grid">
  <div class="large-product">
    <img src="https://nasukafoods.site/bumbukacang.jpeg" alt="Sambel Kearifan" <a href="https://nasukafoods.site/trophy.html">
    <h4>Sambel Kacang</h4>
    <p>Rp 25.000</p>
    <button onclick="goToPayment('Sambel Kearifan Lokal', 25000, 'fisik')">Beli Sekarang</button>
  </div>

  <div class="large-product">
    <img src="https://nasukafoods.site/wingungu.gif" alt="Kerupuk Viral" onclick="window.location.href='https://nasukafoods.site/trophy.html'">
    <h4>Leaderboard</h4>
    
   
  </div>
</div>


<div class="large-product-grid">
  <div class="large-product">
    <img src="https://nasukafoods.site/paket-cilok-keju.jpg" alt="Sambel Kearifan" onclick="goToDeskripsi('Sambel Kearifan Lokal', 25000)">
    <h4>Cilok Keju</h4>
    <p>Rp 25.000</p>
    <button onclick="goToPayment('Sambel Kearifan Lokal', 25000, 'fisik')">Beli Sekarang</button>
  </div>

  <div class="large-product">
    <img src="https://nasukafoods.site/paket-cilok-pedas.jpg" alt="Kerupuk Viral" onclick="goToDeskripsi('Kerupuk Viral', 8000)">
    <h4>Cilok Ayam Pedas</h4>
    <p>Rp 400 an</p>
    <button onclick="goToPayment('Kerupuk Viral', 8000, 'fisik')">Beli Sekarang</button>
  </div>
</div>






<nav>
  <button onclick="location.href='index.html'">üè† Home</button>
  <button onclick="location.href='https://nasukafoods.site/galeri.html'">üö™ Pintu</button>
  <button id="loginBtn" onclick="location.href='profil-vip.html'">üë§ Akun</button>
  
  <button id="loginBtn" onclick="location.href='profil-vip.html'">üë§ Akun</button>
  
</nav>


<script>
  const URL_GAS = "https://script.google.com/macros/s/AKfycbwL9L9lI4GViVClRwcGN4dg2iyqhN_bPGnuwFL5v1Q_UMp5uZqdbQJmy9LIYwG81Dqy/exec";
  const username = localStorage.getItem("username");

  let currentToaIndex = 0;
  let toaIntervalId;

  if (username) {
    fetch(`${URL_GAS}?action=getProfileByUsername&username=${encodeURIComponent(username)}`)
      .then(res => res.json())
      .then(data => {
        if (data && data.Username) {
          document.getElementById("nama").textContent = data.Nama || "_";
          document.getElementById("saldo").textContent = "üíµ " + formatRupiah(data.Saldo || 0);
          document.getElementById("loginBtn").style.display = "none";
          document.getElementById("logoutBtn").style.display = "inline-block";
        }
      })
      .catch(err => console.log("Gagal koneksi profil:", err));
  }

  function logoutUser() {
    localStorage.clear();
    location.reload();
  }

  function formatRupiah(angka) {
    if (!angka || isNaN(angka)) return "Rp 0";
    return 'Rp ' + angka.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ".");
  }

  function goToPayment(productName, productPrice, productType) {
    const orderDetails = {
      name: productName,
      price: productPrice,
      quantity: 1,
      type: productType
    };
    localStorage.setItem('currentOrder', JSON.stringify(orderDetails));

    const visitorData = {
      nama: "Budi Santoso", 
      email: "budi.santoso@example.com",
      telepon: "081234567890",
      alamat: "Jl. Contoh No. 123, Kota Contoh, Provinsi Contoh",
      catatan: ""
    };
    localStorage.setItem('visitorInfo', JSON.stringify(visitorData));

    if (productType === 'digital') {
      window.location.href = 'digital-payment.html';
    } else {
      window.location.href = 'pembayaran.html';
    }
  }

  function goToDeskripsi(productName, productPrice) {
    const detail = {
      name: productName,
      price: productPrice
    };
    localStorage.setItem('deskripsiProduk', JSON.stringify(detail));
    window.location.href = 'deskripsi.html';
  }

  const IP_KEY = (() => {
    let key = localStorage.getItem("visitorID");
    if (!key) {
      key = "id_" + Math.random().toString(36).substring(2);
      localStorage.setItem("visitorID", key);
    }
    return key;
  })();

  async function updateOnline() {
    try {
      await fetch(`${URL_GAS}?action=updateOnlineStatus&ip=${IP_KEY}`);
      
      const res = await fetch(`${URL_GAS}?action=getOnlineCount`);
      const data = await res.json();
      
      const onlineStatus = document.getElementById('online-status');
      if (onlineStatus && data.count) {
        onlineStatus.textContent = `Transaksi sukses(${data.count})`;
      }

      await loadToaData(); 

    } catch (err) {
      console.warn("Gagal update online atau memuat Toa:", err);
    }
  }

  async function loadToaData() {
      try {
          const response = await fetch(`${URL_GAS}?action=getToa`); 
          if (!response.ok) {
              throw new Error(`HTTP error! status: ${response.status}`);
          }
          const data = await response.json(); 
          const toas = data.toas; 

          const activeToas = toas.filter(item => {
              const statusValue = String(item.Status || '').trim().toLowerCase();
              return statusValue === 'aktif';
          });

          displayRotatingToas(activeToas);
          
      } catch (error) {
          console.error("Gagal mengambil data Toa:", error);
          
          
          
          
          
          
          
          const toaDisplayElement = document.getElementById('toa-display-area');
          if (toaDisplayElement) {
              toaDisplayElement.innerHTML = '<p style="color: red;">Gagal memuat Toa.</p>';
          }
      }
  }

function displayRotatingToas(toas) {
    const toaDisplayElement = document.getElementById('toa-display-area'); 
    if (!toaDisplayElement) return;
    if (toaIntervalId) clearInterval(toaIntervalId);

    if (toas.length === 0) {
        toaDisplayElement.innerHTML = '<p>Tidak ada Toa aktif saat ini.</p>';
        return;
    }

    function showNextToa() {
        const toa = toas[currentToaIndex];
        const nama = toa.Nama || 'Anonim';
        const pesan = toa.Pesan || 'Tidak ada pesan.';

        toaDisplayElement.innerHTML = `
            <div class="marquee"><span><strong>${nama}:</strong> ${pesan}</span></div>
        `;

        currentToaIndex = (currentToaIndex + 1) % toas.length;
    }

    showNextToa();
    
    
    toaIntervalId = setInterval(showNextToa, 4000); 
}


function displayRotatingToas(toas) {
    const toaDisplayElement = document.getElementById('toa-display-area');
    if (!toaDisplayElement) return;

    
    if (toaIntervalId) {
        clearInterval(toaIntervalId);
    }

    if (toas.length === 0) {
       
        toaDisplayElement.querySelector('.toa-marquee-text').textContent = 'Tidak ada Toa aktif saat ini.';
        return;
    }


    const toaSpan = toaDisplayElement.querySelector('.toa-marquee-text');

    function showNextToa() {
        const toa = toas[currentToaIndex];
        const nama = toa.Nama || 'Anonim';
        const pesan = toa.Pesan || 'Tidak ada pesan.';

        
        toaSpan.textContent = ` ‚≠ê ${nama}  :  ${pesan}`;

      
        currentToaIndex = (currentToaIndex + 1) % toas.length;
    }

    showNextToa();
    toaIntervalId = setInterval(showNextToa, 4000);
}


  
  updateOnline();

  setInterval(updateOnline, 10000); 
  
  function rand(min, max) {
    return Math.floor(Math.random() * (max - min + 1)) + min;
  }

  function getFakeOnlineCount() {
    const hour = new Date().getHours();
    
    if (hour >= 7 && hour <= 17) return rand(800, 3000);   // jam kerja, misal realistis
    
    
    if (hour >= 18 && hour <= 22) return rand(40, 70);  // malam
    return rand(10, 30);                                // dini hari
  }

  function updateFakeOnlineUI() {
    const fakeCount = getFakeOnlineCount();
    document.getElementById("onlineCount").textContent = fakeCount + " pengguna online";
  }

  // Jalankan pertama kali + update berkala
  updateFakeOnlineUI();
  setInterval(updateFakeOnlineUI, 3000); // update tiap 10 detik
 
</script>
</body>
</html>
