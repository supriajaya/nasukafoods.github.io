
<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Background Penuh</title>
 


  <script src="https://www.gstatic.com/firebasejs/12.1.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/12.1.0/firebase-database-compat.js"></script>

  <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.9.1/dist/confetti.browser.min.js"></script>
  <style>
   <body>   
      
      html, body {
      margin: 0;
      padding: 0;
      height: 100%;
    }

    body {
      background-image: url('foto.jpg');  /* ganti dengan fotomu */
      background-size: cover;   /* gambar selalu isi penuh */
      background-position: center; /* posisi fokus di tengah */
      background-repeat: no-repeat; /* jangan diulang */
    }
    
    
    
    
      
      #main-view {
  background-image: url('https://nasukafoods.site/gol.jpg');
  background-size: cover; /* Agar gambar mengisi seluruh area */
  background-position: center; /* Posisikan gambar di tengah */
  background-repeat: no-repeat; /* Hindari pengulangan gambar */
  background-attachment: fixed; /* (Opsional) Biarkan gambar latar belakang tetap saat menggulir */
}

#profile-view {
  background-image: url('URL_GAMBAR_UNTUK_PROFILE_VIEW');
  background-size: cover;
  background-position: center;
  background-repeat: no-repeat;
  background-attachment: fixed;
}

#chat-view {
  background-image: url('URL_GAMBAR_UNTUK_CHAT_VIEW');
  background-size: cover;
  background-position: center;
  background-repeat: no-repeat;
  background-attachment: fixed;
}

#leaderboard-view {
  background-image: url('https://nasukafoods.site/langit.jpg');
  background-size: cover;
  background-position: center;
  background-repeat: no-repeat;
  background-attachment: fixed;
}

#edit-profile-view {
  background-image: url('URL_GAMBAR_UNTUK_EDIT_PROFILE_VIEW');
  background-size: cover;
  background-position: center;
  background-repeat: no-repeat;
  background-attachment: fixed;
}

#game-view {
  background-image: url('https://nasukafoods.site/langit.jpg');
  background-size: cover;
  background-position: center;
  background-repeat: no-repeat;
  background-attachment: fixed;
}


#burung-container {
    background-image: url('https://nasukafoods.site/langit.jpg');
    
    background-position: center;
}

#roll-container {
    background-image: url('https://nasukafoods.site/langit.jpg');
    background-size: cover;
    background-position: center;
}

      
      
      
      
      
      
      
  

    /* Shared Styles */                                        
    .arya-scol {
      display: flex;
      overflow-x: auto;
      white-space: nowrap;
      padding: 5px;
      gap: 10px;
      margin-top: -1px;
    }
    .arya-scol::-webkit-scrollbar {
      display: none;
    }
    .arya-scol img {
      width: 150px;
      aspect-ratio: 1 / 1;
      border-radius: 3px;
      object-fit: cover;
      flex: 0 0 auto;
    }
    .arya-bar {
      display: flex;
      align-items: center;
      gap: 2px;
      padding: 2px;
      overflow-x: auto;
    }
    .arya-bar::-webkit-scrollbar {
      display: none;
    }
    .arya-item {
      width: 250px;
      aspect-ratio: 1 / 1;
      border-radius: 2px;
      object-fit: cover;
      flex-shrink: 0;
      box-shadow: 0 2px 6px rgba(0, 0, 0, 0.2);
    }
    .arya-item {
      border: 1px solid red;
      padding: 2px;
    }
    .arya-overlay {
      position: relative;
      display: inline-block;
    }
    .arya-overlay img {
      display: block;
    }
    .arya-overlay span {
      position: absolute;
      bottom: 4px;
      left: 4px;
      color: black;
      padding: 2px 1px;
      border-radius: 1px;
      font-size: 10px;
      font-weight: bold;
      max-width: 90%;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      text-shadow: 0 0 6px white, 0 0 8px green, 0 0 10px red;
    }
    .profil-overlay {
      position: relative;
      display: inline-block;
    }
    .profil-overlay img {
      display: block;
      
      
    }
    .profil-overlay span {
      position: absolute;
      bottom: 4px;
      left: 4px;
      color: white;
      padding: 2px 1px;
      border-radius: 1px;
      font-size: 40px;
      font-weight: bold;
      max-width: 90%;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      text-shadow: 0 0 6px white, 0 0 8px green, 0 0 10px red;
    }
    .post-item {
      display: flex;
      gap: 10px;
      background: #fff;
      border-radius: 8px;
      padding: 50px;
       width: 900px;
     
      
      
      
      margin-bottom: 12px;
      box-shadow: 0 1px 4px rgba(0, 0, 0, 0.1);
    }
    .foto-post {
      width: 80px;
      height: 80px;
      border-radius: 100%;
      object-fit: cover;
    }
    #notifInbox {
      position: absolute;
      top: 20px;
      right: 12px;
      padding: 2px 6px;
      cursor: pointer;
      min-width: 20px;
      text-align: center;
      user-select: none;
      display: none;
    }
    .terutus {
      display: flex;
      justify-content: center;
      gap: 20px;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      padding: 10px 0;
      background-color: white;
      z-index: 1000;
      box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2); 
    }
    .terbiwih {
      display: flex;
      justify-content: center;
      gap: 10px;
      position: fixed;
      bottom: 0;
      left: 0;
      width: 100%;
      background-color: white;
      padding: 10px 0;
      z-index: 1000;
      box-shadow: 0 -2px 5px rgba(0, 0, 0, 0.2);
    }
    .varis {
      background-color: rgba(255, 255, 255, 0.1);
      border: 1px solid red;
      color: black;
      padding: 5px 20px;
      text-decoration: none;
      font-weight: bold;
      border-radius: 900px;
      transition: background-color 0.3s;
      text-align: center;
      font-size: 40px;
    }
    
    
    
    .form-post {
      padding: 10px;
      display: flex;
      flex-direction: column;
      align-items: flex-start;
    }
    label {
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 6px;
      cursor: pointer;
      
      
    }
    #btnPosting {
      background: #2196f3;
      color: white;
      padding: 10px 18px;
      border: none;
      border-radius: 20px;
      cursor: pointer;
      font-size: 50px;
    }
    .btnKirim {
      background: #ff9800;
      color: white;
      padding: 8px 14px;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      font-size: 14px;
    }
    .container {
      display: flex;
      flex-wrap: wrap;
      justify-content: space-between;
      padding: 10px
    }
    .nasuka {
      flex: 0 0 48%;
      background-color: #fff;
      margin-bottom: 10px;
      border-radius: 8px;
      overflow: hidden;
      box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
      text-align: center;
      box-sizing: border-box
    }
    .nasuka img {
      width: 100%;
      height: auto;
      display: block
    }
    
    .card img:not([src]) {
      display: none;
      height: 0;
      width: 0;
      padding: 0;
      margin: 0;
    }
    .nasuka-info {
      padding: 40px
    }
    
    
    .nasuka-info.left {
      text-align: left
    }
    .postingan {
      padding: 10px
    }
    .card {
      background: #fff;
      margin-bottom: 10px;
      border-radius: 6px;
      box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
      overflow: hidden;
      position: relative
    }
    .card img {
      width: 99%;
      height: auto
    }
    .card-content {
      padding: 10px;
      text-align: left
    }
    .hapus-btn {
      position: absolute;
      top: 10px;
      right: 10px;
      background-color: red;
      color: white;
      border: none;
      padding: 6px 10px;
      font-size: 12px;
      border-radius: 4px;
      cursor: pointer
    }
    .komentar {
      padding: 100px
    }
    .komentar input {
      width: 100%;
      box-sizing: border-box;
      padding: 50px;
      margin-bottom: 5px
    }
    .komentar-list {
      max-height: 100px;
      overflow-y: auto;
      font-size: 50px;
      color: #333
    }
    .komentar-list div {
      margin-bottom: 5px
    }
    .card-content h3 {
      margin-top: 0;
      margin-bottom: 5px;
    }
    .card-content small {
      margin: 0;
    }

    /* Chat Styles */
    .msg {
      max-width: 70%;
      margin: 5px 0;
      padding: 8px 12px;
      border-radius: 10px;
      word-wrap: break-word;
      display: inline-block;
    }
    .msg.me {
      background-color: #dcf8c6;
      align-self: flex-end;
      border-top-right-radius: 0;
      text-align: right;
    }
    .msg:not(.me) {
      background-color: #ffffff;
      align-self: flex-start;
      border-top-left-radius: 0;
      text-align: left;
    }
    .time {
      font-size: 10px;
      color: #888;
      margin-top: 2px;
      display: block;
    }
    #inputMessage {
      resize: none;
      overflow: hidden;
    }
    #topBar {
      display: flex;
      align-items: center;
      padding: 10px;
      background-color: green;
      cursor: pointer;
    }
    #targetFotoEl {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      object-fit: cover;
      margin-right: 10px;
    }
    #roomTitle {
      font-weight: bold;
      color: white;
    }
    #chatBox {
      display: flex;
      flex-direction: column;
      padding: 10px;
      height: calc(100vh - 120px);
      overflow-y: auto;
      background: #e5ddd5;
    }
    #inputContainer {
      display: flex;
      padding: 10px;
      border-top: 1px solid #ccc;
      background: #f0f0f0;
    }
    #inputMessage {
      flex: 1;
      padding: 10px;
      border: 1px solid #ccc;
      border-radius: 5px;
      font-size: 1rem;
      min-height: 40px;
    }
    #cusBtn {
      margin-left: 10px;
      padding: 10px 16px;
      background: #4caf50;
      color: white;
      border: none;
      border-radius: 5px;
      font-size: 1.2rem;
      cursor: pointer;
      user-select: none;
    }
    #cusBtn:active {
      background: #388e3c;
    }
    
    

    /* Leaderboard Styles */
    #leaderboard-view .terutus a,
    #leaderboard-view .terbiwih a {
      font-size: 38px;
    }

    #leaderboard-view .konten {
      display: flex;
      flex-wrap: wrap;
      justify-content: space-between;
      
      font-size: 26px;
    }
    #leaderboard-view .nasuka-info.centered {
      text-align: center;
      font-size: 26px;
    }
    #leaderboard-view .namajuara {
      display: inline-block;
      
      
      padding: 1px 2px;
      border-radius: 1px;
      text-decoration: none;
      font-weight: bold;
      margin-top: 10px;
      border: 2px solid ;
      font-size: 26px;
    }
    #leaderboard-view .perakjuara {
      font-size: 56px;
      
      margin-bottom: 8px;
    }

    @media (max-width: 48px) {
      #leaderboard-view .nasuka {
        flex: 0 0 49%;
        font-size: 200px;
      }
      #leaderboard-view .namajuara {
        padding: 1px 2px;
        font-size: 80px;
      }
    }

    #leaderboard-view .juara1-konten {
      justify-content: center;
    }

    #leaderboard-view .foto-juara {
      width: 400px;
      height: 400px;
      border-radius: 8px;
      object-fit: cover;
      display: block;
      margin: 0 auto 8px auto;
      border: 1px solid #ccc;
    }
    
    
    
    

    /* Edit Profile Styles */
    #edit-profile-view .form-container {
      background:white;
      max-width:100%;
      width:100%;
      box-sizing:border-box;
      margin:auto;
      padding:16px;
      border-radius:8px;
      box-shadow:0 2px 8px rgba(0,0,0,0.1);
      margin-top: 110px;
    }
    #edit-profile-view h2 {
      margin-top:0;
      font-size:1.2rem;
    }
    #edit-profile-view input,
    #edit-profile-view textarea {
      width:100%;
      padding:10px;
      margin:8px 0 16px;
      border:1px solid #ccc;
      border-radius:4px;
      font-size:1rem;
      box-sizing:border-box;
    }
    #edit-profile-view label {
      font-weight:bold;
      display:block;
      font-size:0.9rem;
    }
    #edit-profile-view button {
      background-color:#1877f2;
      color:white;
      padding:12px;
      border:none;
      border-radius:4px;
      cursor:pointer;
      width:100%;
      font-size:1rem;
    }
    #edit-profile-view button:hover {
      background-color:#145dbf;
    }
    #edit-profile-view img.preview {
      width:100px;
      height:100px;
      object-fit:cover;
      display:block;
      margin-bottom:12px;
      border-radius:4px;
    }
    #edit-profile-view #status {
      margin-top:10px;
      font-size:0.9rem;
      color:#333;
    }

    /* --- Game Styles --- */
    .atasanaturan {
      display: flex;
      justify-content: center;
      gap: 10px;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      background-color: white; 
      padding: 10px 0; 
      box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2); 
      z-index: 1000;
    }

    .bawahanaturan {
      display: flex;
      justify-content: center;
      gap: 10px;
      position: fixed;
      bottom: 0;
      left: 0;
      width: 100%;
      background-color: white; 
      padding: 10px 0; 
      box-shadow: 0 -2px 5px rgba(0, 0, 0, 0.2);
      z-index: 1000; 
    }

    .variansiaturan {
      background-color: rgba(255, 255, 255, 0.1);
      border: 2px solid red;
      color: black;
      padding: 10px 20px;
      text-decoration: none;
      font-weight: bold;
      border-radius: 5px;
      transition: background-color 0.3s;
      text-align: center;
      font-size: 38px; 
    }     
    
    .judul-aturan {
      font-size: 40px;
      font-weight: bold;
      margin-bottom: 5px;
    }

    .aturan {
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      margin-top: 100px;
      margin-bottom: 20px;
    }

    .aturan p {
      margin-top: 10px;
      font-size: 30px;
      font-weight: bold;
      text-align: left;
      width: 95%;
      box-sizing: border-box;
      margin-bottom: 1px;
    }
 
 
 
 
 
 
 
    .perspective-on { perspective: 1000px; }
    .perspective-off { perspective: 0; }
    
    .tilted { transform: rotateY(45deg); }
    .spin-0  { transform: rotateX(-3600deg); }
    .spin-1  { transform: rotateX(-3636deg); }
    .spin-2  { transform: rotateX(-3672deg); }
    .spin-3  { transform: rotateX(-3708deg); }
    .spin-4  { transform: rotateX(-3744deg); }
    .spin-5  { transform: rotateX(-3780deg); }
    .spin-6  { transform: rotateX(-3816deg); }
    .spin-7  { transform: rotateX(-3852deg); }
    .spin-8  { transform: rotateX(-3888deg); }
    .spin-9  { transform: rotateX(-3924deg); }
    
    @keyframes back-spin { 100% { transform: rotateX(36deg); } }
    @keyframes tiltin { 0% { transform: rotateY(0deg);} 50% { transform: rotateY(0deg);} 100% { transform: rotateY(45deg);} }
    @keyframes tiltout { 0% { transform: rotateY(45deg);} 100% { transform: rotateY(0deg);} }
    @keyframes spin-0  { 0% { transform: rotateX(36deg); } 100% { transform: rotateX(-3600deg); } }
    @keyframes spin-1  { 0% { transform: rotateX(36deg); } 100% { transform: rotateX(-3636deg); } }
    @keyframes spin-2  { 0% { transform: rotateX(36deg); } 100% { transform: rotateX(-3672deg); } }
    @keyframes spin-3  { 0% { transform: rotateX(36deg); } 100% { transform: rotateX(-3708deg); } }
    @keyframes spin-4  { 0% { transform: rotateX(36deg); } 100% { transform: rotateX(-3744deg); } }
    @keyframes spin-5  { 0% { transform: rotateX(36deg); } 100% { transform: rotateX(-3780deg); } }
    @keyframes spin-6  { 0% { transform: rotateX(36deg); } 100% { transform: rotateX(-3816deg); } }
    @keyframes spin-7  { 0% { transform: rotateX(36deg); } 100% { transform: rotateX(-3852deg); } }
    @keyframes spin-8  { 0% { transform: rotateX(36deg); } 100% { transform: rotateX(-3888deg); } }
    @keyframes spin-9  { 0% { transform: rotateX(36deg); } 100% { transform: rotateX(-3924deg); } }
    
    #resultDisplay {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 600px;
      height: 600px;
      z-index: 9999;
      pointer-events: none;
    }
    
    #numbersDisplay {
      position: absolute;
      top: 50px;
      left: 50%;
      transform: translateX(-50%);
      font-size: 40px;
      font-weight: bold;
      color: #000;
      background: rgba(255, 255, 255, 0.9);
      padding: 10px 20px;
      border-radius: 10px;
      z-index: 10000;
      display: flex;
      gap: 10px;
    }
    
    #timeDisplay {
      position: absolute;
      top: 20px;
      left: 20px;
      font-size: 18px;
      color: #000;
      background: rgba(255, 255, 255, 0.9);
      padding: 10px 20px;
      border-radius: 10px;
      z-index: 10000;
      text-align: left;
    }
    
    #rotate {
      margin: 0 auto;
      width: 700px;
      height: 700px;
      padding-top: 700px;
      transform-style: preserve-3d;
      transform: rotateY(45deg);
    }
    
    .ring {
      margin: 0 auto;
      height: 115px;
      width: 115px;
      float: left;
      transform-style: preserve-3d;
    }
    
    .roll {
      position: absolute;
      width: 120px;
      height: 120px;
      box-sizing: border-box;
      opacity: 0.9;
      color: black;
      background: white;
      border: solid 5px #ccc;
      backface-visibility: visible;
    }
    
    .roll p {
      font-size: 100px;
      font-weight: bold;
      line-height: 130px;
      margin: 0;
      text-align: center;
    }
    
    .backface-on { backface-visibility: visible; }
    
    .bottom-links {
      position: fixed;
      bottom: 20px;
      width: 100%;
      display: flex;
      justify-content: space-between;
      padding: 0 20px;
      box-sizing: border-box;
    }
  
    #spinButton:disabled {
      cursor: not-allowed;
      opacity: 0.6;
    }
  
    #spinButton {
      position: absolute;    
      top: 1500px;
      left: 50%;
      transform: translateX(-50%);
      padding: 30px;
      background-color: blue;
      color: white;
      border: none;
      border-radius: 5px;
      font-size: 30px;
      width: 950px;
    }
    
    .mainting-panel {
      position: absolute;
      top: 1600px;
      left: 20px;
      background: rgba(0,0,0,0.7);
      padding: 15px;
      font-size: 60px;
      border-radius: 10px;
      color: white;
      width: 950px;
      box-shadow: 0 0 10px rgba(0,0,0,0.5);
    }
    
    .main-input {
      width: 100%;
      padding: 8px;
      margin: 5px 0;
      border-radius: 5px;
      border: none;
      background-color: #333;
      color: white;
      font-size: 30px;
    }
    
    .main-button {
      background-color: #4CAF50;
      color: white;
      border: none;
      font-size: 2px;
      padding: 8px 15px;
      margin: 5px 2px;
      border-radius: 5px;
      cursor: pointer;
      transition: background-color 0.3s;
    }
    
    .main-button:hover {
      background-color: #45a049;
    }
    
    .main-button:disabled {
      background-color: #cccccc;
      cursor: not-allowed;
    }
    
    .result-message {
      margin-top: 10px;
      padding: 10px;
      border-radius: 5px;
      text-align: center;
      font-weight: bold;
      transition: all 0.3s ease;
      font-size: 70px;
      
    }
    
   #perakBalance {
      font-weight: ;
      color: snow;
      font-size: 60px;
      
    }
    
   .win {
      background-color: rgba(255, 215, 0, 0.7) !important;
      color: black !important;
    }

    .win-types {
      margin-top: 15px;
      font-size: 30px;
      background-color: rgba(255, 215, 0, 0.7) !important;
      color: black !important;
    }

    .win-type {
      display: flex;
      justify-content: space-between;
      margin: 5px 0;
      background-color: rgba(255, 215, 0, 0.7) !important;
      color: black !important;
    }

    #numbersDisplay {
      position: absolute;
      top: 20px;
      left: 80%;
      transform: translateX(-50%);
      font-size: 80px;
      font-weight: bold;
      background: snow;
      padding: 10px 20px;
      border-radius: 5px;
      display: flex;
      gap: 10px;
    }
    
    #numbersDisplay span {
      display: inline-block;
      width: 30px;
      text-align: center;
      font-size: 30px;
    }
    
    #loading {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: grey;
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 1000;
    }
    
    .auto-main-options {
      margin-top: 15px;
      padding-top: 15px;
      border-top: 1px solid #444;
      font-size: 30px;
    }
    
    .auto-main-options h4 {
      margin-bottom: 10px;
      font-size: 30px;
    }
    
    #automainButtons {
      display: flex;
      flex-wrap: wrap;
      gap: 5px;
      font-size: 30px;
    }
    
    #automainButtons button {
      flex: 1;
      min-width: 50px;
      padding: 5px;
      background-color: #333;
      border: none;
      border-radius: 4px;
      color: white;
      cursor: pointer;
      font-size: 30px;
    }
    
    #automainButtons button.active {
      background-color: #4CAF50;
      font-weight: bold;
      font-size: 30px;
    }
    
    #automainButtons button:last-child {
      background-color: #f44336;
      font-size: 30px;
    }
    
    .result-hidden {
      opacity: 0;
      height: 0;
      overflow: hidden;
      margin: 0;
      padding: 0;
      transition: all 0.3s ease;
    }
    
    .rolling-text {
      position: fixed;
      bottom: 10px;
      left: 10px;
      color: black;
      font-size: 30px;
      opacity: 0.7;
      z-index: 100;
      font-size: 30px;
    }

    .link-container {
      display: flex;
      justify-content: center;
      gap: 10px;
      margin-bottom: 20px;
    }
    
    .menu-link {
      background-color: rgba(255, 255, 255, 0.1);
      border: 2px solid red;
      color: black;
      padding: 10px 20px;
      text-decoration: none;
      font-weight: bold;
      border-radius: 5px;
      transition: background-color 0.3s;
      text-align: center;
      font-size: 28px; 
    }
    
    .menu-link:hover {
      background-color: rgba(255, 255, 255, 0.2);
    }

    .history-link-container {
      position: absolute;
      bottom: 20px;
      left: 20px;
    }     
    
    .error-message {
      color: red;
      font-weight: bold;
      text-align: center;
      margin-top: 10px;
      display: none;
    }
    
    .bling-bling {
      animation: glowing 1.5s infinite alternate;
      text-shadow: 0 0 5px #fff, 0 0 10px #fff, 0 0 15px #ff7, 0 0 20px #ff7, 0 0 25px #ff0, 0 0 30px #ff0, 0 0 35px #ff0;
    }

    @keyframes glowing {
      from {
        text-shadow: 0 0 5px #fff, 0 0 10px #fff, 0 0 15px #ff7, 0 0 20px #ff7, 0 0 25px #ff0, 0 0 30px #ff0, 0 0 35px #ff0;
      }
      to {
        text-shadow: 0 0 10px #fff, 0 0 20px #fff, 0 0 30px #ff0, 0 0 40px #ff0, 0 0 50px #ff7, 0 0 60px #ff7, 0 0 70px #ff7;
      }
    }
    
    .link-container {
      position: relative;
      z-index: 200000;
    }
    
    .menu-link {
      background-color: rgba(255, 255, 255, 0.1);
      border: 2px solid red;
      color: snow;
      padding: 10px 20px;
      text-decoration: none;
      font-weight: bold;
      border-radius: 5px;
      transition: background-color 0.3s;
      text-align: center;
      font-size: 28px; 
      background: rgba(0,0,0,0.7);
    }
      
    .menu-link:hover {
      background-color: rgba(255, 255, 255, 0.2);
    }

    .history-link-container {
      position: absolute;
      bottom: 20px;
      left: 20px;
    }
    
    .auto-spin-buttons {
        display: flex;
        justify-content: center;
        margin-top: 15px;
        gap: 10px;
    }
    .auto-spin-buttons button {
        padding: 15px 30px;
        font-size: 24px;
        border-radius: 5px;
        border: none;
        cursor: pointer;
        width: 45%;
        color: white;
    }
    #startAutoSpinButton {
        background-color: #4CAF50;
    }
    #stopAutoSpinButton {
        background-color: #f44336;
        display: none; 
    }
  
  
  
  
  
  
    .input-circle ~ .pajaro { opacity: 0; transition: 0.3s cubic-bezier(0,.43,1,0); animation: move 8s infinite alternate; }
    .pajaro.hidden { opacity: 0 !important; }
    .pajaro.hide-all { display: none !important; }

    .input-circle1:not(:checked) ~ .pajaro1,
    .input-circle2:not(:checked) ~ .pajaro2,
    .input-circle3:not(:checked) ~ .pajaro3,
    .input-circle4:not(:checked) ~ .pajaro4,
    .input-circle5:not(:checked) ~ .pajaro5,
    .input-circle6:not(:checked) ~ .pajaro6,
    .input-circle7:not(:checked) ~ .pajaro7,
    .input-circle8:not(:checked) ~ .pajaro8,
    .input-circle9:not(:checked) ~ .pajaro9,
    .input-circle10:not(:checked) ~ .pajaro10,
    .input-circle12:not(:checked) ~ .pajaro12,
    .input-circle13:not(:checked) ~ .pajaro13,
    .input-circle14:not(:checked) ~ .pajaro14,
    .input-circle15:not(:checked) ~ .pajaro15,
    .input-circle16:not(:checked) ~ .pajaro16,
    .input-circle17:not(:checked) ~ .pajaro17,
    .input-circle18:not(:checked) ~ .pajaro18,
    .input-circle19:not(:checked) ~ .pajaro19,
    .input-circle20:not(:checked) ~ .pajaro20,
    .input-circle21:not(:checked) ~ .pajaro21,
    .input-circle22:not(:checked) ~ .pajaro22,
    .input-circle23:not(:checked) ~ .pajaro23,
    .input-circle24:not(:checked) ~ .pajaro24,
    .input-circle25:not(:checked) ~ .pajaro25,
    .input-circle26:not(:checked) ~ .pajaro26,
    .input-circle27:not(:checked) ~ .pajaro27 { opacity: 1; }

    .input-circle1:checked ~ .pajaro1 span,
    .input-circle2:checked ~ .pajaro2 span,
    .input-circle3:checked ~ .pajaro3 span,
    .input-circle4:checked ~ .pajaro4 span,
    .input-circle5:checked ~ .pajaro5 span,
    .input-circle6:checked ~ .pajaro6 span,
    .input-circle7:checked ~ .pajaro7 span,
    .input-circle8:checked ~ .pajaro8 span,
    .input-circle9:checked ~ .pajaro9 span,
    .input-circle10:checked ~ .pajaro10 span,
    .input-circle12:checked ~ .pajaro12 span,
    .input-circle13:checked ~ .pajaro13 span,
    .input-circle14:checked ~ .pajaro14 span,
    .input-circle15:checked ~ .pajaro15 span,
    .input-circle16:checked ~ .pajaro16 span,
    .input-circle17:checked ~ .pajaro17 span,
    .input-circle18:checked ~ .pajaro18 span,
    .input-circle19:checked ~ .pajaro19 span,
    .input-circle20:checked ~ .pajaro20 span { display: block; }

    .pajaro7  { top: 150px; animation-delay: -4s !important; transform: scale(1.0); }
    .pajaro8  { top: 250px; animation-delay: -5s !important; transform: scale(0.7); }
    .pajaro9  { top: 300px; animation-delay: -6s !important; transform: scale(1.1); }
    .pajaro10 { top: 150px; animation-delay: -7s !important; transform: scale(0.9); }
    .pajaro11 { top: 250px; animation-delay: -8s !important; transform: scale(1.2); }
    .pajaro12 { top: 300px; animation-delay: -9s !important; transform: scale(0.6); }
    .pajaro13 { top: 70px; animation-delay: -10s !important; transform: scale(1.3); }
    .pajaro14 { top: 120px; animation-delay: -11s !important; transform: scale(0.85); }
    .pajaro15 { top: 180px; animation-delay: -12s !important; transform: scale(1.15); }
    .pajaro16 { top: 220px; animation-delay: -13s !important; transform: scale(0.95); }
    .pajaro17 { top: 280px; animation-delay: -14s !important; transform: scale(1.05); }
    .pajaro18 { top: 320px; animation-delay: -15s !important; transform: scale(0.75); }
    .pajaro19 { top: 90px; animation-delay: -16s !important; transform: scale(1.25); }
    .pajaro20 { top: 140px; animation-delay: -17s !important; transform: scale(0.65); }

    .pajaro > span {
      display: none;
      position: absolute;
      z-index: 2;
      left: -250%;
      bottom: -50%;
      background-color: blue;
      border: solid 2px #000;
      width: 80px;
      height: 30px;
      padding: 10px;
      border-radius: 50%;
    }

    .pajaro > span:before {
      content: "1 Perak";
      color: yellow;
      font-weight: bold;
    }

    .pajaro1 { top: 50px; animation-delay: -2s !important; transform: scale(0.9); }
    .pajaro2 { top: 100px; animation-delay: -1s !important; transform: scale(0.8); }
    .pajaro3 { top: 200px; animation-delay: -3s !important; transform: scale(1.4); }
    .pajaro4 { top: 50px; animation-delay: -12s !important; transform: scale(0.9); }
    .pajaro5 { top: 100px; animation-delay: -16s !important; transform: scale(0.5); }
    .pajaro6 { top: 200px; animation-delay: -20s !important; transform: scale(1.4); }

    @keyframes move {
      10% { left: 10%; }
      20% { left: 20%; top: 50%; }
      40% { top: 30%; left: 60%; }
      60% { top: 80%; left: 80%; }
      80% { top: 10%; left: 20%; }
      100% { top: 30%; left: 20%; }
    }

    .pajaro:after,
    .pajaro:before {
      content: "";
      position: absolute;
      top: 50%;
      left: 50%;
    }

    .pajaro:after {
      box-shadow: inset 0px 11px 0 black;    
      border-radius: 100% 100% 0 0;
      width: 200px;
      height: 200px;
      margin-top: -5px;
      margin-left: -90px;
      transform-origin: 100% 0%;
      animation: alas 3s linear infinite;
    }

    .pajaro {
      background: gray;
      position: absolute;
      left: 0;
      cursor: crosshair;
      border-radius: 50% 50% 20% 20%;
      color: white;
      line-height: 20px;
      letter-spacing: 2px;
      font-size: 0.8em;
      text-align: center;
      margin-top: -10px;
      margin-left: 0px;
      width: 30px;
      height: 30px;
      animation: planeo 0.8s linear infinite;
      z-index: 999;
    }

    .pajaro:before {
      background: black;
      border-radius: 100% 0% 20% 0%;
      margin-top: 12px;
      margin-left: -5px;
      width: 12px;
      height: 12px;
      transform: rotateZ(45deg);
    }

    @keyframes alas {
      50% { transform: rotateX(-1440deg); }
    }

    .sum {
      position: fixed;
      left: 1%;
      top: 20px;
      font-size: 50px;
      font-weight: bold;
    }       
         
    .button-container-flex {
      display: flex;
      justify-content: center;
      gap: 100px;
      position: fixed;
      bottom: 10px;
      width: 99%;
      heigh: 99%;
    }
      
    .menu-link {
      background-color: rgba(255, 255, 255, 0.1);
      border: 2px solid red;
      color: black;
      padding: 10px 20px;
      text-decoration: none;
      font-weight: bold;
      border-radius: 5px;
      transition: background-color 0.3s;
      text-align: center;
      font-size: 28px; 
    }
    
    .menu-link:hover {
      background-color: rgba(255, 255, 255, 0.2);
    }

    .history-link-container {
      position: absolute;
      bottom: 20px;
      left: 20px;
    }     
    
    .error-message {
      color: red;
      font-weight: bold;
      text-align: center;
      margin-top: 10px;
      display: none;
    }
    
    .bling-bling {
      animation: glowing 1.5s infinite alternate;
      text-shadow: 0 0 5px #fff, 0 0 10px #fff, 0 0 15px #ff7, 0 0 20px #ff7, 0 0 25px #ff0, 0 0 30px #ff0, 0 0 35px #ff0;
    }

    @keyframes glowing {
      from {
        text-shadow: 0 0 5px #fff, 0 0 10px #fff, 0 0 15px #ff7, 0 0 20px #ff7, 0 0 25px #ff0, 0 0 30px #ff0, 0 0 35px #ff0;
      }
      to {
        text-shadow: 0 0 10px #fff, 0 0 20px #fff, 0 0 30px #ff0, 0 0 40px #ff0, 0 0 50px #ff7, 0 0 60px #ff7, 0 0 70px #ff7;
      }
    }
    
    .link-container {
      position: relative;
      z-index: 200000;
    }
    
    .menu-link {
      background-color: rgba(255, 255, 255, 0.1);
      border: 2px solid red;
      color: snow;
      padding: 10px 20px;
      text-decoration: none;
      font-weight: bold;
      border-radius: 5px;
      transition: background-color 0.3s;
      text-align: center;
      font-size: 28px; 
      background: rgba(0,0,0,0.7);
    }
      
    .menu-link:hover {
      background-color: rgba(255, 255, 255, 0.2);
    }

    .history-link-container {
      position: absolute;
      bottom: 20px;
      left: 20px;
    }
    
    .auto-spin-buttons {
        display: flex;
        justify-content: center;
        margin-top: 15px;
        gap: 10px;
    }
    .auto-spin-buttons button {
        padding: 15px 30px;
        font-size: 24px;
        border-radius: 5px;
        border: none;
        cursor: pointer;
        width: 45%;
        color: white;
    }
    #startAutoSpinButton {
        background-color: #4CAF50;
    }
    #stopAutoSpinButton {
        background-color: #f44336;
        display: none; 
    }











    .box {
      background: white;
      padding: 20px;
      border-radius: 8px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.2);
      width: 100%;
      max-width: 320px;
      box-sizing: border-box;
      text-align: center;
    }
    .box h2 {
      margin-top: 0;
      margin-bottom: 16px;
    }
    .box input {
      width: 100%;
      padding: 10px;
      margin-bottom: 12px;
      border: 1px solid #ccc;
      border-radius: 6px;
      box-sizing: border-box;
    }
    .box button {
      width: 100%;
      padding: 10px;
      background-color: #2196F3;
      color: white;
      border: none;
      border-radius: 6px;
      font-weight: bold;
      cursor: pointer;
    }
    .box button:hover {
      background-color: #1976D2;
    }
    .link {
      display: block;
      margin-top: 15px;
      font-size: 14px;
      color: #2196F3;
      text-decoration: none;
      cursor: pointer;
    }
    .link:hover {
      text-decoration: underline;
    }
    .error-msg {
      color: red;
      margin-bottom: 10px;
      font-size: 14px;
    }









  </style>
</head>
<body>

  <div id="main-view">
    <div class="terutus" style="margin-top: 1px;">
      <a href="#" class="varis" onclick="showView('leaderboard-view')">Leaderboard</a>
      
      <a href="#" class="varis" onclick="alert('Fitur Mendatang sedang dalam pengembangan.')">Fitur Mendatang</a>
      <a href="#" class="varis" onclick="alert('Fitur Event sedang dalam pengembangan.')">Event</a>
    </div>

    <div style="padding:20px; text-align:center; margin-top: 100px;">
      <input id="cariUser" placeholder="Cari akun....." />
      <div id="hasilUser" style="margin-top:1px"></div>
    </div>

    <div class="terbiwih">
      <a href="#" class="varis" onclick="alert('Faq sedang dalam pengembangan.')">Faq</a>
      <a href="#" class="varis" onclick="alert('Privacy Policy sedang dalam pengembangan.')">Privacy Policy</a>
      <a href="#" class="varis" onclick="alert('Return Policy sedang dalam pengembangan.')">Return Policy</a>
      <a href="#" class="varis" onclick="alert('Term & Condition sedang dalam pengembangan.')">Term & Condition</a>
    </div>

    <div class="arya-bar raya" style="position: relative;">
      <div class="profil-overlay">
        <a id="linkProfil" href="#" onclick="showMyProfile()">
          <img src="https://nasukafoods.site/gambarkosong.jpg" class="arya-item raya" id="fotoProfil" />
        </a>
        <span id="namaUser" class="blink-glow">Memuat....</span>
      </div>
      <div class="profil-overlay" style="position: relative; display: inline-flex; align-items: center; gap: 6px;">
        <img src="https://nasukafoods.site/nasukachat.png" class="arya-item raya" id="fol" onclick="showChatSendersList(localStorage.getItem('ID'))"/>
        <span></span>
        <span id="notifInbox"></span>
      </div>

      <div class="arya-scol">
        <div class="arya-overlay">
          <a href="#" onclick="showGame('burung')"><img src="https://nasukafoods.site/nasukabird.jpg" /></a>
        </div>
        <div class="arya-overlay">
          <a href="#" onclick="showGame('roll')"><img src="https://nasukafoods.site/roll.jpg" /></a>
        </div>
        <div class="arya-overlay">
          <a href="https://nasukafoods.site/nasuka.apk"><img src="https://nasukafoods.site/download.png" /><span></span></a>
        </div>
      </div>
    </div>
    <div id="daftarPostingan" style="padding: 10px;"></div>
  </div>




<div id="login-view" style="display:none; padding-top:60px; text-align:center;">
  <div class="box" id="loginBox" style="margin:auto;max-width:350px;">
    <div id="errorLogin" class="error-msg"></div>
    <input type="text" id="loginUsername" placeholder="Username" />
    <input type="password" id="loginPassword" placeholder="Password" />
    <button onclick="login()">Masuk</button>
    <span class="link" onclick="showSignup()">Belum punya akun? Bikin akun disini</span>
  </div>

  <div class="box" id="signupBox" style="display:none; margin:auto;max-width:350px;">
    <div id="errorSignup" class="error-msg"></div>
    <input type="text" id="signupNama" placeholder="Nama" />
    <input type="text" id="signupUsername" placeholder="Username" />
    <input type="password" id="signupPassword" placeholder="Password" />
    <button onclick="signup()">Buat Akun Sekarang</button>
    <span class="link" onclick="showLogin()">Sudah punya akun? Masuk disini</span>
  </div>
</div>







  <div id="profile-view" style="display: none;">
    <div style="text-align: center; margin-top: 20px;">
      <button onclick="showView('main-view')" style="padding: 10px; font-size: 16px;">Kembali ke Beranda</button>
      <button onclick="showView('edit-profile-view')" style="padding: 10px; font-size: 16px;">Edit Profil</button>
    </div>
    <div class="container">
      <div class="nasuka">
        <img id="foto-profil" src="https://nasukafoods.site/gambarkosong.jpg" alt="FOTO PROFIL" />
        <br/>
        <div id="tombolAksi"></div>
      </div>
      <div class="nasuka">
        <div class="nasuka-info left" id="dataUser">
          <p>🎇 Nama</p>
          <p>🎇 Perak</p>
          <p>🎇 Jenis</p>
          <p>🎇 Kirim Pesan</p>
        </div>
      </div>
    </div>
    <div class="nasuka" style="width:100%;margin:0;">
      <div class="form-post" id="post-form-section">
        <textarea id="judul" placeholder="Tulis postingan" autocomplete="off" style="height:80px;"></textarea>
        <select id="status">
          <option value="publik">Publik</option>
          <option value="privat">Privat</option>
        </select>
        <label style="display:flex;justify-content:center;align-items:center;gap:6px;cursor:pointer;width:100%;">
          📷
          <input type="file" id="fotoInput" accept="image/*" style="display:none;" />
        </label>
        <button id="btnPosting" onclick="kirimPostingan()">Posting</button>
      </div>
    </div>
    <div class="postingan" id="daftarPostinganProfil"></div>
  </div>

  <div id="chat-view" style="display: none;">
    <div id="topBar" onclick="showView('main-view')">
      <img id="targetFotoEl" src="" alt="Foto" />
      <span id="roomTitle">Chat</span>
    </div>
    <div id="chatBox"></div>
    <div id="inputContainer">
      <textarea id="inputMessage" rows="1" placeholder="Ketik pesan..."></textarea>
      <button id="cusBtn" onclick="kirim()">&#9658;</button>
    </div>
  </div>

  <div id="leaderboard-view" style="display: none; padding-top: 50px;">
    <div class="terutus">
        <a class="varis" onclick="showView('leaderboard-view')">Leaderboard</a>
    </div>

    <div class="terbiwih">
        <a class="varis">Rich</a>
      
        <a class="varis">Royal</a>
        <a class="varis"></a>
        <a href="#" class="varis" onclick="showView('main-view')">Kembali</a>
    </div>

    <div class="konten juara1-konten">
      <div class="nasuka" id="juara1-box">
        <div class="nasuka-info centered">
          <div class="perakjuara" id="juara1-title"></div>
          <img id="juara1-foto" class="foto-juara" src="https://nasukafoods.site/gambarkosong.jpg" alt="Foto Juara 1">
          <a href="#" class="namajuara" id="juara1-nama">1</a>
          <p id="juara1-nilai">0</p>
        </div>
      </div>
    </div>

    <div class="konten juara2dan3-konten">
      <div class="nasuka" id="juara2-box">
        <div class="nasuka-info left">
          <div class="perakjuara" id="juara2-title"></div>
          <img id="juara2-foto" class="foto-juara" src="https://nasukafoods.site/gambarkosong.jpg" alt="Foto Juara 2">
          <a href="#" class="namajuara" id="juara2-nama">2</a>
          <p id="juara2-nilai">0</p>
        </div>
      </div>

      <div class="nasuka" id="juara3-box">
        <div class="nasuka-info left">
          <div class="perakjuara" id="juara3-title"></div>
          <img id="juara3-foto" class="foto-juara" src="https://nasukafoods.site/gambarkosong.jpg" alt="Foto Juara 3">
          <a href="#" class="namajuara" id="juara3-nama">3</a>
          <p id="juara3-nilai">0</p>
        </div>
      </div>
    </div>

    <div class="konten juara4dst-konten">
      <ul id="juara4-list"></ul>
    </div>
  </div>

  <div id="edit-profile-view" style="display: none;">
    <div class="terutus" style="margin-top: 50px;">
        <a class="varis" onclick="showView('main-view')">Kembali</a>
    </div>
    <div class="form-container">
      <h2>Edit Profil</h2>
      <form id="editForm">
        <input type="hidden" id="ID" />
        <label>Username</label>
        <input type="text" id="Username" />
        <label>Password</label>
        <input type="password" id="Password" />
        <label>Nama</label>
        <input type="text" id="Nama" />
        <label>Telepon</label>
        <input type="text" id="Telepon" />
        <label>Alamat</label>
        <textarea id="Alamat"></textarea>
        <label>Foto Profil</label>
        <img id="fotoPreview" class="preview" src="" alt="Preview Foto" />
        <input type="file" id="fotoProfilInput" accept="image/*" />
        <input type="hidden" id="Foto" />
        <button type="submit">Simpan Perubahan</button>
      </form>
      <div id="status"></div>
    </div>
  </div>

  <div id="modalGambar" style="display: none;position: fixed;z-index: 9999;top: 0;left: 0;width: 100%;height: 100%;background: rgba(0,0,0,0.8);justify-content: center;align-items: center;">
    <img id="gambarModal" src="" style="max-width: 95%; max-height: 95%; border-radius: 8px" />
  </div>

  <div id="game-view" style="display: none;">
    <div id="roll-container">      
      <div class="link-container">
           
    
          <a href="#" class="menu-link" onclick="showGame('burung')">Perak Gratis</a>
      </div>

      <div id="loading">Memuat Game...</div>
      <div id="stage" class="perspective-on">
        <div id="rotate" class="tilted">
          <div id="ring1" class="ring"></div>
          <div id="ring2" class="ring"></div>
          <div id="ring3" class="ring"></div>
          <div id="ring4" class="ring"></div>
          <div id="ring5" class="ring"></div>
        </div>

        <audio id="winAudio" src="https://nasukafoods.site/slavafunk.mp3" preload="auto"></audio>
        <audio id="slotAudio" src="https://nasukafoods.site/mesinslot.mp3" preload="auto"></audio>

        <button id="spinButton">Putar</button>
        <div class="mainting-panel">
          <div>♨️ : <span id="perakBalance">0</span></div>
          <div id="errorMessage" class="error-message"></div>
          <div class="auto-main-options">
            <div id="automainButtons">
              <button onclick="selectmain(1)" id="main1">1</button>
              <button onclick="selectmain(100)" id="main100">100</button>
              <button onclick="selectmain(1000)" id="main1000">1.000</button>
              <button onclick="selectmain(10000)" id="main10000">10.000</button>
              <button onclick="selectmain(0)">off</button>
            </div>
          </div>
          <div class="auto-spin-buttons">
            <button id="startAutoSpinButton"> Otomatis</button>
            <button id="stopAutoSpinButton">Hentikan</button>
          </div>
          <div id="mainResult" class="result-message result-hidden"></div>
        </div>
      </div>
      
      <div class="history-link-container">
        <a href="#" onclick="showView('main-view')" class="menu-link">Beranda</a>
      </div>
    </div>
     </div>
    </div> </div>
    </div>
    
    
    
    
    
    
    <div id="burung-container" style="display:none;">
      <div class="burungan">
        <div class="button-container-flex">
            <button id="selesai">AMBIL</button>
            <button id="rollBtn" onclick="showGame('roll')">Main Roll</button>
        </div>
      </div>
      
      <div id="customAlert" style="display: none; position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); background: white; padding: 20px; border-radius: 10px; box-shadow: 0 0 20px rgba(0,0,0,0.2); z-index: 1001; text-align: center; max-width: 80%;">
        <div id="alertIcon" style="font-size: 90px; margin-bottom: 15px;"></div>
        <div id="alertMessage" style="font-size: 50px; margin-bottom: 20px;"></div>
        <button id="alertOkBtn" style="background: #4CAF50; color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer;">OK</button>
      </div>
      <input class="input-circle input-circle1" type="radio" id="circle1" name="burung_group">
      <input class="input-circle input-circle2" type="radio" id="circle2" name="burung_group">
      <input class="input-circle input-circle3" type="radio" id="circle3" name="burung_group">
      <input class="input-circle input-circle4" type="radio" id="circle4" name="burung_group">
      <input class="input-circle input-circle5" type="radio" id="circle5" name="burung_group">
      <input class="input-circle input-circle6" type="radio" id="circle6" name="burung_group">
      <input class="input-circle input-circle7" type="radio" id="circle7" name="burung_group">
      <input class="input-circle input-circle8" type="radio" id="circle8" name="burung_group">
      <input class="input-circle input-circle9" type="radio" id="circle9" name="burung_group">
      <input class="input-circle input-circle10" type="radio" id="circle10" name="burung_group">
      <input class="input-circle input-circle11" type="radio" id="circle11" name="burung_group">
      <input class="input-circle input-circle12" type="radio" id="circle12" name="burung_group">
      <input class="input-circle input-circle13" type="radio" id="circle13" name="burung_group">
      <input class="input-circle input-circle14" type="radio" id="circle14" name="burung_group">
      <input class="input-circle input-circle15" type="radio" id="circle15" name="burung_group">
      <input class="input-circle input-circle16" type="radio" id="circle16" name="burung_group">
      <input class="input-circle input-circle17" type="radio" id="circle17" name="burung_group">
      <input class="input-circle input-circle18" type="radio" id="circle18" name="burung_group">
      <input class="input-circle input-circle19" type="radio" id="circle19" name="burung_group">
      <input class="input-circle input-circle20" type="radio" id="circle20" name="burung_group">
      <label for="circle1" class="pajaro pajaro1"><span></span></label>
      <label for="circle2" class="pajaro pajaro2"><span></span></label>
      <label for="circle3" class="pajaro pajaro3"><span></span></label>
      <label for="circle4" class="pajaro pajaro4"><span></span></label>
      <label for="circle5" class="pajaro pajaro5"><span></span></label>
      <label for="circle6" class="pajaro pajaro6"><span></span></label>
      <label for="circle7" class="pajaro pajaro7"><span></span></label>
      <label for="circle8" class="pajaro pajaro8"><span></span></label>
      <label for="circle9" class="pajaro pajaro9"><span></span></label>
      <label for="circle10" class="pajaro pajaro10"><span></span></label>
      <label for="circle11" class="pajaro pajaro11"><span></span></label>
      <label for="circle12" class="pajaro pajaro12"><span></span></label>
      <label for="circle13" class="pajaro pajaro13"><span></span></label>
      <label for="circle14" class="pajaro pajaro14"><span></span></label>
      <label for="circle15" class="pajaro pajaro15"><span></span></label>
      <label for="circle16" class="pajaro pajaro16"><span></span></label>
      <label for="circle17" class="pajaro pajaro17"><span></span></label>
      <label for="circle18" class="pajaro pajaro18"><span></span></label>
      <label for="circle19" class="pajaro pajaro19"><span></span></label>
      <label for="circle20" class="pajaro pajaro20"><span></span></label>
      <div class="sum">🎁<span id="total-perak">0</span> Perak Gratis</div>
    </div>
     </div>
    </div>
     </div>
    
    </div>
     </div>
    
    
    
    
    
    
    
    
    

    
      
        <div id="rulle-container" style="display:none;">    
     
        
      
        <div class="box">
    
    <a class="error-msg"> Login </a>
    </div>
    
    
    <input type="text" id="loginUsername" placeholder="Username" />
    <input type="password" id="loginPassword" placeholder="Password" />
    <button onclick="login()">Masuk</button>
    <span class="link" onclick="showSignup()">Belum punya akun? Bikin akun disini</span>
  </div>

  <div class="box" id="signupBox" style="display:none">
   
    <div id="errorSignup" class="error-msg"></div>
    <input type="text" id="signupNama" placeholder="Nama" />
    <input type="text" id="signupUsername" placeholder="Username" />
    <input type="password" id="signupPassword" placeholder="Password" />
    <button onclick="signup()">Buat Akun Sekarang</button>
    <span class="link" onclick="showLogin()">Sudah punya akun? Masuk disini</span>
  </div>
 </div>
    </div>
       </div>
    </div>
      
      
      
      
      
      
      
      
      
      
      
      
     
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    <div id="investor-container" style="display:none;">    
      <div class="container">
        <div class="header-receipt">
          <h2>NASUKA WIRELESS</h2>
          <p>Jl. Eretan Wetan — Kandanghaur</p>
          <p>Indramayu - Jawabarat</p>
        </div>
        <div class="receipt-line"></div>
        <form id="topupForm">
          <label for="id">ID:</label>
          <input type="text" id="id" name="id" required>
          <label for="nama">Nama:</label>
          <input type="text" id="nama" name="nama" required>
          <label for="username">Username:</label>
          <input type="text" id="username" name="username" required>
          <label for="deposit">Jumlah:</label>
          <input type="number" id="deposit" name="deposit" required>
          <label for="bukti">Bukti Tf:</label>
          <div class="file-upload-burungan">
            <label class="custom-file-upload" for="bukti">PILIH FOTO</label>
            <span class="file-name" id="file-name"></span>
            <input type="file" id="bukti" name="bukti" accept="image/jpeg,image/png" required>
          </div>
          <button type="submit">BELI PERAK</button>
        </form>
        <div id="statusMessage"></div>
        <div id="transactionReceipt" style="display:none;">
          <div class="header-receipt">
            <h2>STRUK TRANSAKSI</h2>
          </div>
          <div class="receipt-line"></div>
          <div class="receipt-details" id="receiptDetails"></div>
          <div class="receipt-line"></div>
          <div class="header-receipt">
            <p>Terima kasih atas kepercayaan Anda.</p>
            <p>NASUKA WIRELESS</p>
          </div>
        </div>
        <div class="bawahanaturan">    
          <a href="#" class="variansiaturan" onclick="showGame('roll')">Ke Roll</a> 
        </div>
      </div> 
    </div>
  </div>


  <script>
    
const firebaseConfig = {
  apiKey: "AIzaSyASa57fEz1c31GwQ_1SR0UyLPbWOEuk8vs",
  authDomain: "nasukaapp.firebaseapp.com",
  databaseURL: "https://nasukaapp-default-rtdb.asia-southeast1.firebasedatabase.app",
  projectId: "nasukaapp",
  messagingSenderId: "853986671478",
  appId: "1:853986671478:web:25b1c3f0b72149c5885857"
};







    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();
    const userCache = {};
    let isPosting = false;
    let viewedProfileID = null;

    const ID = localStorage.getItem('ID') || 'test-user-id';
    const Username = localStorage.getItem('Username') || 'test-username';
    const Nama = localStorage.getItem('Nama') || 'Test User';
    let currentTargetID = '';
    let currentTargetNama = '';
    let currentTargetFoto = '';
    let activeChatListener = null;
    let selectedFile = null;

    document.addEventListener("DOMContentLoaded", () => {
      showView('main-view');
      initializeUserProfile();
      setupSearchFunctionality();
      setupChatNotifications();
      loadPosts();
      setupEditProfileForm();

      const modalGambar = document.getElementById("modalGambar");
      if (modalGambar) {
        modalGambar.addEventListener("click", () => {
          modalGambar.style.display = "none";
        });
      }

      // Initialize game scripts
      for (let i = 1; i <= 5; i++) createROLL($('#ring' + i));
      $('#rotate').addClass('tilted');
      $('.roll').addClass('backface-on');
      setTimeout(() => {
        $('#loading').fadeOut();
      }, 2000);
      let winAudio = document.getElementById('winAudio');
      let userInteracted = false;
      $('#spinButton').click(function() {
        if (!userInteracted) {
          winAudio.muted = true;
          winAudio.play().then(() => {
            winAudio.pause();
            winAudio.currentTime = 0;
            winAudio.muted = false;
            userInteracted = true;
          }).catch(error => {
            console.error("Audio play blocked:", error);
          });
        }
        if (!$(this).prop('disabled')) {
          spin(true);
        }
      });
      $('#startAutoSpinButton').click(startAutoSpin);
      $('#stopAutoSpinButton').click(stopAutoSpin);
      setupBurungGame();
      setupInvestorForm();
    });

    // --- Main View Management ---
    function showView(viewId) {
      document.getElementById('main-view').style.display = 'none';
      document.getElementById('profile-view').style.display = 'none';
      document.getElementById('chat-view').style.display = 'none';
      document.getElementById('leaderboard-view').style.display = 'none';
      document.getElementById('edit-profile-view').style.display = 'none';
      document.getElementById('game-view').style.display = 'none';
      
      document.getElementById(viewId).style.display = 'block';

      if (viewId === 'leaderboard-view') {
        loadLeaderboard();
      } else if (viewId === 'edit-profile-view') {
        loadProfileDataForEdit();
      }
    }

    // --- Game View Management ---
    function showGame(gameId) {
        document.getElementById('main-view').style.display = 'none';
        document.getElementById('game-view').style.display = 'block';

        document.getElementById('roll-container').style.display = 'none';
        document.getElementById('burung-container').style.display = 'none';
        document.getElementById('rulle-container').style.display = 'none';
        document.getElementById('investor-container').style.display = 'none';
        
        document.getElementById(gameId + '-container').style.display = 'block';
    }

    async function loadAndShowProfile(id) {
      const currentID = localStorage.getItem("ID");
      if (!currentID) {
        alert("Silakan login terlebih dahulu.");
        return;
      }
      viewedProfileID = id;

      const snap = await db.ref("users").orderByChild("ID").equalTo(viewedProfileID).once("value");
      const user = Object.values(snap.val() || {})[0];

      if (user) {
        renderUser(user, currentID);
        muatPostinganProfil(viewedProfileID);
        showView('profile-view');
      } else {
        alert("Pengguna tidak ditemukan.");
        showView('main-view');
      }
    }

    function showMyProfile() {
      const myID = localStorage.getItem("ID");
      if (myID) {
        loadAndShowProfile(myID);
      } else {
        alert("Silakan masuk untuk melihat profil Anda.");
      }
    }

    function showChatView(targetID) {
      loadTargetInfo(targetID).then(() => {
        document.getElementById('targetFotoEl').src = currentTargetFoto;
        document.getElementById('roomTitle').textContent = currentTargetNama;
        loadChat([ID, currentTargetID].sort().join('_'));
        showView('chat-view');
      }).catch(err => {
        console.error("Gagal memuat chat:", err);
        alert("Gagal memuat chat.");
      });
    }

    // --- Social Media App Scripts (as provided) ---
    function initializeUserProfile() {
      const userID = localStorage.getItem("ID") || "";
      const fotoEl = document.getElementById("fotoProfil");
      const namaEl = document.getElementById("namaUser");
      const profilLink = document.getElementById("linkProfil");
     
        
        
        if (!userID) {
  if (namaEl) {
    namaEl.innerHTML = `<a href="#" onclick="showLogin()">Silakan Masuk</a>`;
  }

  if (fotoEl) fotoEl.src = "https://nasukafoods.site/gambarkosong.jpg";
  if (profilLink) profilLink.onclick = () => alert("Silakan login terlebih dahulu");
                               
        
  if (profilLink) {
    pro // arahkan juga link profil ke loginfilLink.onclick = () => showLogin();
  }
}
        
        
        
        
        
      
      
      
      
      
      

      const nama = localStorage.getItem("Nama");
      const foto = localStorage.getItem("Foto");
      if (nama && foto) {
        updateProfileDisplay(nama, foto, userID);
      } else {
        fetchUserProfileFromDB(userID);
      }
    }

    function updateProfileDisplay(nama, foto, userID) {
      const namaEl = document.getElementById("namaUser");
      const fotoEl = document.getElementById("fotoProfil");
      const profilLink = document.getElementById("linkProfil");
      if (namaEl) namaEl.textContent = nama;
      if (fotoEl) fotoEl.src = foto;
      if (profilLink) profilLink.onclick = () => loadAndShowProfile(userID);
    }

    function fetchUserProfileFromDB(userID) {
      db.ref("users").orderByChild("ID").equalTo(userID).once("value").then(snap => {
        snap.forEach(child => {
          const val = child.val();
          localStorage.setItem("Nama", val.Nama || "Tanpa Nama");
          localStorage.setItem("Foto", val.Foto || "https://nasukafoods.site/gambarkosong.jpg");
          updateProfileDisplay(val.Nama || "Tanpa Nama", val.Foto || "https://nasukafoods.site/gambarkosong.jpg", userID);
        });
      });
    }

    function setupSearchFunctionality() {
      const hasilUserEl = document.getElementById("hasilUser");
      const cariUserInput = document.getElementById("cariUser");
      if (!cariUserInput || !hasilUserEl) return;
      cariUserInput.addEventListener("input", function() {
        const k = this.value.trim().toLowerCase();
        hasilUserEl.innerHTML = "";
        if (k.length < 2) return;
        db.ref("users").orderByChild("NamaLower").startAt(k).endAt(k + "\uf8ff").limitToFirst(10).once("value").then(snap => {
          snap.forEach(child => {
            const v = child.val();
            const d = document.createElement("div");
            d.innerHTML = `<div style="display:flex; align-items:center; gap:8px; background:#fff; padding:8px; border-radius:6px; box-shadow:0 1px 4px rgba(0,0,0,0.1)"><img src="${v.Foto || "https://nasukafoods.site/gambarkosong.jpg"}" style="width:40px; height:40px; border-radius:50%; object-fit:cover" /><div style="flex:1"><b>${v.Nama || "Tanpa Nama"}</b><br /><a href="#" onclick="loadAndShowProfile('${v.ID}')" style="font-size:50px; color:#2196F3">Lihat Profil</a></div></div>`;
            hasilUserEl.appendChild(d);
          });
        });
      });
    }

    function setupChatNotifications() {
      const userID = localStorage.getItem("ID") || "";
      const notifInbox = document.getElementById("notifInbox");
      if (!userID || !notifInbox) return;
      const userChatsRef = db.ref(`users/${userID}/chats`);
      userChatsRef.on('value', snapshot => {
        const chats = snapshot.val() || {};
        let unreadCount = 0;
        for (const key in chats) {
          if ((chats[key].read === false || chats[key].read === undefined) && chats[key].ID !== userID) {
            unreadCount++;
          }
        }
        if (unreadCount > 0) {
          notifInbox.style.display = 'inline-block';
          notifInbox.textContent = unreadCount > 99 ? '99+' : unreadCount;
        } else {
          notifInbox.style.display = 'none';
          notifInbox.textContent = '';
        }
      });
    }

    async function showChatSendersList(userID) {
      const snapshot = await db.ref(`users/${userID}/chats`).once('value');
      const chats = snapshot.val() || {};
      if (Object.keys(chats).length === 0) {
        alert('Tidak ada pengirim pesan');
        return;
      }
      const pengirimData = [];
      for (const chatID of Object.keys(chats)) {
        const userSnap = await db.ref('users').orderByChild('ID').equalTo(chatID).once('value');
        userSnap.forEach(u => {
          const nama = u.val().Nama || 'Pengguna';
          pengirimData.push({ id: chatID, nama });
        });
      }
      const container = document.createElement('div');
      container.style.cssText = 'position:fixed;top:50%;left:50%;transform:translate(-50%, -50%);background:#fff;border:1px solid #ccc;border-radius:8px;padding:12px;z-index:9999;max-height:300px;overflow-y:auto;min-width:200px;box-shadow:0 2px 10px rgba(0,0,0,0.2)';
      const closeBtn = document.createElement('button');
      closeBtn.textContent = 'x';
      closeBtn.style.cssText = 'position:absolute;top:6px;right:6px;background:transparent;border:none;font-size:18px;cursor:pointer;';
      closeBtn.onclick = () => document.body.removeChild(container);
      container.appendChild(closeBtn);
      pengirimData.forEach(({ id, nama }) => {
        const btn = document.createElement('button');
        btn.textContent = nama;
        btn.style.cssText = 'display:block;width:100%;margin:6px 0;padding:8px;border:none;border-radius:4px;background:#2196F3;color:#fff;cursor:pointer;';
        btn.onclick = () => {
          document.body.removeChild(container);
          showChatView(id);
        };
        container.appendChild(btn);
      });
      document.body.appendChild(container);
    }

    function loadPosts() {
      const daftar = document.getElementById("daftarPostingan");
      if (!daftar) return;
      daftar.innerHTML = '';
      db.ref("posts").orderByChild("Status").equalTo("publik").limitToLast(20).on("child_added", async postSnap => {
        const post = postSnap.val();
        const postId = postSnap.key;
        const namaPemilik = await getUserData(post.ID);
        const div = document.createElement("div");
        div.className = "post-item";
        div.style.flexDirection = "column";
        div.innerHTML = createPostHTML(namaPemilik, post, postId);
        daftar.prepend(div);
        setupPostInteractions(postId);
      });
    }

    async function getUserData(uid) {
      return new Promise(resolve => {
        if (userCache[uid]) return resolve(userCache[uid]);
        db.ref("users").orderByChild("ID").equalTo(uid).once("value").then(snap => {
          let nama = "Tanpa Nama";
          snap.forEach(u => {
            if (u.val().Nama) nama = u.val().Nama;
          });
          userCache[uid] = nama;
          resolve(nama);
        });
      });
    }

    function createPostHTML(namaPemilik, post, postId) {
      return `
        <div style="text-align:center; font-weight:bold; font-size:70px; margin-bottom:6px">${namaPemilik}</div>
        ${post.Foto ? `<img src="${post.Foto}" class="foto-post" style="width:100px; height:100px; margin:0 auto 8px; display:block; border-radius:8px; object-fit:cover; cursor:pointer" onclick="tampilkanGambarPenuh('${post.Foto}')" />` : ``}
        <div style="font-size:50px; margin:4px 0"><b>${(post.Judul || "").replace(/\n/g, "<br>")}</b></div>
        <div style="font-size:30px; color:black">${post.Waktu ? new Date(post.Waktu).toLocaleString("id-ID") : ""}</div>
        <div style="display:flex; align-items:center; gap:8px; margin-top:8px">
          <button onclick="toggleLike('${postId}')" id="likeBtn-${postId}" style="padding:6px 10px; border:none; border-radius:6px; cursor:pointer; font-size:40px">❤️</button>
          <span id="likeCount-${postId}" style="font-size:40px">0 suka</span>
        </div>
        <div id="komentar-${postId}" style="margin-top:10px; display:none;"></div>
        <button id="lihatKomentarBtn-${postId}" style="margin-top:6px; padding:20px 30px; background:red; color:#fff; border:none; border-radius:6px; cursor:pointer; font-size:43px">Lihat Komentar</button>
        <div style="display:flex; gap:6px; margin-top:6px">
          <textarea id="inputKomentar-${postId}" placeholder="Tulis komentar..." style="flex:1; padding:20px; border:4px solid black; border-radius:2px; font-size:50px; resize:none" rows="1"></textarea>
          
          
          <button onclick="kirimKomentar('${postId}')" style="padding:6px 10px; background:#2196F3; color:white; border:none; border-radius:6px; font-size:50px">Ok</button>
        </div>
      `;
    }

    function setupPostInteractions(postId) {
      const userID = localStorage.getItem("ID") || "";
      db.ref("posts/" + postId + "/likes").on("value", snap => {
        const likeCountEl = document.getElementById("likeCount-" + postId);
        if(likeCountEl) likeCountEl.textContent = `${snap.numChildren()} suka`;
        const likeBtn = document.getElementById("likeBtn-" + postId);
        if (likeBtn) {
          if (snap.hasChild(userID)) {
            likeBtn.textContent = "❤️";
            likeBtn.style.background = "#f8d7da";
          } else {
            likeBtn.textContent = "💔";
            likeBtn.style.background = "#eee";
          }
        }
      });

      let komentarLoaded = false;
      const btnLihat = document.getElementById(`lihatKomentarBtn-${postId}`);
      const wadahKomentar = document.getElementById(`komentar-${postId}`);
      if (btnLihat && wadahKomentar) {
        btnLihat.onclick = () => {
          if (wadahKomentar.style.display === "none") {
            wadahKomentar.style.display = "block";
            btnLihat.textContent = "Sembunyikan Komentar";
            if (!komentarLoaded) {
              db.ref("komentar/" + postId).on("value", snap => {
                wadahKomentar.innerHTML = "";
                snap.forEach(c => {
                  const v = c.val();
                  const d = document.createElement("div");
                  d.style = "background:#f9f9f9; padding:6px; margin-top:4px; border-radius:6px; font-size:42px";
                  d.innerHTML = `<b>${v.Nama || "Anonim"}</b>: ${(v.Teks || "").replace(/\n/g, '<br>')}`;
                  wadahKomentar.appendChild(d);
                });
              });
              komentarLoaded = true;
            }
          } else {
            wadahKomentar.style.display = "none";
            btnLihat.textContent = "Lihat Komentar";
          }
        };
      }
    }

    window.kirimKomentar = function(postId) {
      const userID = localStorage.getItem("ID") || "";
      if (!userID) return alert("Silakan login dulu untuk komentar");
      const nama = localStorage.getItem("Nama") || "Anonim";
      const input = document.getElementById("inputKomentar-" + postId);
      const teks = (input?.value || "").trim();
      if (!teks) return;
      db.ref("komentar/" + postId).push({
        ID: userID,
        Nama: nama,
        Teks: teks,
        Waktu: new Date().toISOString()
      });
      if (input) input.value = "";
    };

    window.toggleLike = function(postId) {
      const userID = localStorage.getItem("ID") || "";
      if (!userID) return alert("Silakan login dulu untuk like");
      const refLike = db.ref("posts/" + postId + "/likes/" + userID);
      refLike.once("value").then(snap => {
        if (snap.exists()) {
          refLike.remove();
        } else {
          refLike.set(true);
        }
      });
    };

    window.tampilkanGambarPenuh = function(src) {
      if (!src) return;
      const modal = document.getElementById("modalGambar");
      const gambar = document.getElementById("gambarModal");
      if (modal && gambar) {
        gambar.src = src;
        modal.style.display = "flex";
      }
    };

    function renderUser(user, currentID) {
      const isOwner = user.ID === currentID;
      document.getElementById("foto-profil").src = user.Foto || "https://nasukafoods.site/gambarkosong.jpg";
      document.getElementById('post-form-section').style.display = isOwner ? 'block' : 'none';
      const dataUserDiv = document.getElementById("dataUser");
      dataUserDiv.innerHTML = `
        <p>🎇 Nama: ${user.Nama || '-'}</p>
        <p>🎇 Perak: ${user.Perak || 0}</p>
        <p>🎇 Jenis: ${user.Jenis || '-'}</p>
      `;
      const tombolAksiDiv = document.getElementById("tombolAksi");
      tombolAksiDiv.innerHTML = '';
      if (!isOwner) {
        const btnPesan = document.createElement("button");
        btnPesan.innerHTML = '🎇 Kirim Pesan';
        btnPesan.style.cssText = 'padding: 8px 16px; margin-top: 10px; cursor: pointer;';
        btnPesan.onclick = () => {
          showChatView(viewedProfileID);
        };
        tombolAksiDiv.appendChild(btnPesan);
      }
    }

    function muatPostinganProfil(id) {
      const daftar = document.getElementById("daftarPostinganProfil");
      if (!daftar) return;
      daftar.innerHTML = '';
      db.ref("posts").orderByChild("ID").equalTo(id).on("child_added", function(snapshot) {
        const data = snapshot.val();
        const key = snapshot.key;
        const isOwner = data.ID === localStorage.getItem("ID");
        const formattedDate = new Date(data.Waktu).toLocaleString('id-ID', {
          year: 'numeric', month: 'long', day: 'numeric', hour: '2-digit', minute: '2-digit'
        });
        const imageHtml = data.Foto ? `<img src="${data.Foto}" alt="Postingan Foto">` : '';
        const card = document.createElement("div");
        card.className = "card";
        card.innerHTML = `
          ${isOwner ? `<button class="hapus-btn" onclick="hapusPostingan('${key}', this.parentElement)">Hapus</button>` : ""}
          ${imageHtml}
          <div class="card-content">
            <h3>${(data.Judul || "").replace(/\n/g, '<br>')}</h3>
            <p style="margin: 50px 0;"><b>Oleh:</b> ${data.Nama}</p>
            <p style="margin: 40px 0;"><small>${formattedDate}</small></p>
            <small>${data.Status}</small><br/>
          </div>
          <textarea id="input-${key}" placeholder="Tulis komentar" style="width:100%; padding:20px;"></textarea><button class="btnKirim" onclick="submitKomentarManual('${key}')">Kirim</button>
          <div class="komentar-list" id="list-${key}"></div>
        `;
        const likeSpan = document.createElement("span");
        likeSpan.style.cssText = "cursor:pointer; display:inline-block; margin-top:10px; font-weight:bold;";
        likeSpan.onclick = () => toggleLike(key);
        card.querySelector(".card-content").appendChild(likeSpan);
        daftar.prepend(card);
        updateLikeDisplay(key, likeSpan);
        muatKomentar(key);
      });
    }

    window.kirimPostingan = function() {
      if (isPosting) return;
      isPosting = true;
      const judul = document.getElementById("judul").value.trim();
      const status = document.getElementById("status").value;
      const file = document.getElementById("fotoInput").files[0];
      if (!judul && !file) {
        isPosting = false;
        return;
      }
      const ID = localStorage.getItem("ID");
      const Nama = localStorage.getItem("Nama");
      if (!ID || !Nama) {
        isPosting = false;
        return;
      }
      const postData = { ID, Nama, Judul: judul, Status: status, Waktu: Date.now() };
      function resetForm() {
        document.getElementById("judul").value = "";
        document.getElementById("status").value = "publik";
        document.getElementById("fotoInput").value = "";
        isPosting = false;
      }
      if (file) {
        const reader = new FileReader();
        reader.onload = e => {
          postData.Foto = e.target.result;
          db.ref("posts").push(postData).then(resetForm).catch(() => {
            isPosting = false;
          });
        };
        reader.readAsDataURL(file);
      } else {
        db.ref("posts").push(postData).then(resetForm).catch(() => {
          isPosting = false;
        });
      }
    }

    window.hapusPostingan = function(key, cardElement) {
      const updates = {};
      updates["/posts/" + key] = null;
      updates["/komentar/" + key] = null;
      db.ref().update(updates);
      cardElement.remove();
    }

    window.submitKomentarManual = function(key) {
      const input = document.getElementById("input-" + key);
      const teks = input.value.trim();
      if (teks) {
        const id = localStorage.getItem("ID") || "";
        const nama = localStorage.getItem("Nama") || "Anonim";
        db.ref("komentar/" + key).push({
          ID: id,
          Nama: nama,
          Teks: teks,
          Waktu: new Date().toLocaleString("id-ID")
        });
        input.value = "";
      }
    }

    function muatKomentar(key) {
      db.ref("komentar/" + key).on("child_added", snap => {
        const data = snap.val();
        const list = document.getElementById("list-" + key);
        if (list) {
          const div = document.createElement("div");
          div.innerHTML = `<b>${data.Nama || "?"}:</b> ${(data.Teks || "").replace(/\n/g, '<br>')}`;
          list.appendChild(div);
        }
      });
    }

    function updateLikeDisplay(postId, elemen) {
      db.ref("posts/" + postId + "/likes").on("value", snap => {
        const likeCount = snap.numChildren();
        elemen.innerText = `👍 ${likeCount}`;
      });
    }

    function loadTargetInfo(targetID) {
      return db.ref('users').orderByChild('ID').equalTo(targetID).once('value').then(snap => {
        let found = false;
        snap.forEach(userSnap => {
          const val = userSnap.val();
          currentTargetID = val.ID;
          currentTargetNama = val.Nama || 'Pengguna';
          currentTargetFoto = val.Foto || 'default.jpg';
          found = true;
        });
        if (!found) {
          currentTargetID = targetID;
          currentTargetNama = 'Pengguna';
          currentTargetFoto = 'default.jpg';
        }
      });
    }

    function formatWaktu(ms) {
      const d = new Date(ms);
      const jam = d.getHours().toString().padStart(2, '0');
      const mnt = d.getMinutes().toString().padStart(2, '0');
      return jam + ':' + mnt;
    }

    function tambahPesan(data) {
      const msgEl = document.createElement('div');
      msgEl.className = data.ID === ID ? 'msg me' : 'msg';

      const text = document.createElement('div');
      text.textContent = data.Pesan;

      const time = document.createElement('span');
      time.className = 'time';
      time.textContent = formatWaktu(data.Waktu || 0);

      msgEl.appendChild(text);
      msgEl.appendChild(time);
      document.getElementById('chatBox').appendChild(msgEl);

      document.getElementById('chatBox').scrollTop = document.getElementById('chatBox').scrollHeight;
    }

    function loadChat(room) {
      document.getElementById('chatBox').innerHTML = '';

      if (activeChatListener) {
        db.ref('rooms/' + room + '/chats').off('child_added', activeChatListener);
      }

      activeChatListener = snap => {
        const data = snap.val();
        tambahPesan(data);
      };

      db.ref('rooms/' + room + '/chats').on('child_added', activeChatListener);
    }

    function kirim() {
      const msg = document.getElementById('inputMessage').value.trim();
      if (!msg) return;

      const waktu = Date.now();
      const pesanData = {
        ID,
        Username,
        Nama,
        Pesan: msg,
        Waktu: waktu
      };

      const room = [ID, currentTargetID].sort().join('_');
      const chatRef = db.ref('rooms/' + room + '/chats');

      chatRef.push(pesanData).then(() => {
        const lastChatDataForMe = {
          room: room,
          ID: currentTargetID,
          Username: currentTargetNama,
          Foto: currentTargetFoto,
          Terakhir: msg,
          Waktu: waktu
        };

        const lastChatDataForTarget = {
          room: room,
          ID: ID,
          Username: Nama,
          Foto: '',
          Terakhir: msg,
          Waktu: waktu
        };

        const updates = {};
        updates[`users/${ID}/chats/${currentTargetID}`] = lastChatDataForMe;
        updates[`users/${currentTargetID}/chats/${ID}`] = lastChatDataForTarget;
        updates[`rooms/${room}/lastChat`] = {
          ID: ID,
          Nama: Nama,
          Pesan: msg,
          Waktu: waktu,
          readBy: {
            [ID]: true
          }
        };

        db.ref().update(updates);

        document.getElementById('inputMessage').value = '';
        document.getElementById('inputMessage').style.height = 'auto';
      }).catch(err => {
        alert("Gagal mengirim pesan: " + err.message);
      });
    }

    document.getElementById('inputMessage').addEventListener('input', () => {
      document.getElementById('inputMessage').style.height = 'auto';
      document.getElementById('inputMessage').style.height = document.getElementById('inputMessage').scrollHeight + 'px';
    });

    function loadLeaderboard() {
      getLeaderboard("Perak");
    }

    function updateChampionBox(rank, user, type) {
      const nameEl = document.getElementById(`juara${rank}-nama`);
      const valueEl = document.getElementById(`juara${rank}-nilai`);
      const fotoEl = document.getElementById(`juara${rank}-foto`);

      if (nameEl) nameEl.textContent = user.Nama || "Anonymous";
      if (nameEl) nameEl.href = `javascript:void(0);`;
      if (valueEl) valueEl.textContent = `${user[type] || 0} ${type}`;
      if (fotoEl) {
        if (user.Foto) {
          fotoEl.src = user.Foto;
          fotoEl.style.display = "block";
        } else {
          fotoEl.style.display = "none";
        }
      }
    }

    function updateChampionList(users, type) {
      const list = document.getElementById("juara4-list");
      list.innerHTML = "";

      users.forEach((user, index) => {
        const rank = index + 4;

        const li = document.createElement("li");
        li.style.display = "flex";
        li.style.alignItems = "center";
        li.style.margin = "10px 0";

        const foto = document.createElement("img");
        foto.src = user.Foto || "https://nasukafoods.site/gambarkosong.jpg";
        foto.alt = `Foto Juara ${rank}`;
        foto.style.width = "160px";
        foto.style.height = "160px";
        foto.style.objectFit = "cover";
        foto.style.borderRadius = "8px";
        foto.style.border = "2px solid #ccc";
        foto.style.marginRight = "10px";

        const info = document.createElement("div");
        info.innerHTML = `
          <a href="#" onclick="loadAndShowProfile('${user.ID}')" class="namajuara" style="padding:4px 8px;font-size:24px;margin:0 6px;">
            ${rank}. ${user.Nama || "Anonymous"}
          </a><br>
          <span style="font-size:22px;color:green;">${user[type] || 0} ${type}</span>
        `;

        li.appendChild(foto);
        li.appendChild(info);
        list.appendChild(li);
      });
    }

    function getLeaderboard(type) {
      const leaderboardRef = db.ref('users').orderByChild(type).limitToLast(10);

      leaderboardRef.on('value', (snapshot) => {
        const users = [];
        snapshot.forEach((childSnapshot) => {
          const user = childSnapshot.val();
          user.ID = childSnapshot.key;
          users.push(user);
        });

        users.sort((a, b) => (parseFloat(b[type]) || 0) - (parseFloat(a[type]) || 0));

        for (let i = 0; i < 3; i++) {
          if (users[i]) updateChampionBox(i + 1, users[i], type);
        }

        if (users.length > 3) {
          updateChampionList(users.slice(3), type);
        }
      });
    }
    
    function setupEditProfileForm() {
        const fotoProfilInput = document.getElementById("fotoProfilInput");
        const editForm = document.getElementById("editForm");
        
        if (fotoProfilInput) {
            fotoProfilInput.addEventListener("change", function(e) {
                const file = e.target.files[0];
                if (file && file.type.startsWith("image/")) {
                    selectedFile = file;
                    const reader = new FileReader();
                    reader.onload = function(evt) {
                        document.getElementById("fotoPreview").src = evt.target.result;
                    };
                    reader.readAsDataURL(file);
                }
            });
        }
        
        if (editForm) {
            editForm.addEventListener("submit", function(e) {
                e.preventDefault();
                saveProfile();
            });
        }
    }
    
    function loadProfileDataForEdit() {
        const userID = localStorage.getItem("ID");
        const username = localStorage.getItem("Username");
        const statusEl = document.getElementById("status");

        if (!username) {
            if(statusEl) statusEl.innerText = "Username tidak ditemukan. Silakan login ulang.";
            return;
        }

        document.getElementById("ID").value = userID;
        
        db.ref("users/" + username).once("value").then(snapshot => {
            const data = snapshot.val();
            if (data) {
                document.getElementById("Username").value = data.Username || "";
                document.getElementById("Password").value = data.Password || "";
                document.getElementById("Nama").value = data.Nama || "";
                document.getElementById("Telepon").value = data.Telepon || "";
                document.getElementById("Alamat").value = data.Alamat || "";
                document.getElementById("Foto").value = data.Foto || "";
                document.getElementById("fotoPreview").src = data.Foto || "";
            } else {
                if(statusEl) statusEl.innerText = "Data pengguna tidak ditemukan di database.";
            }
        }).catch(err => {
            if(statusEl) statusEl.innerText = "Gagal mengambil data: " + err.message;
        });
    }

    function saveProfile() {
      const username = localStorage.getItem("Username");
      const statusEl = document.getElementById("status");
      const namaBaru = document.getElementById("Nama").value.trim();

      function saveData(fotoData) {
          const data = {
              Username: document.getElementById("Username").value,
              Password: document.getElementById("Password").value,
              Nama: namaBaru,
              NamaLower: namaBaru.toLowerCase(),
              Telepon: document.getElementById("Telepon").value,
              Alamat: document.getElementById("Alamat").value,
              Foto: fotoData
          };

          db.ref("users/" + username).update(data).then(() => {
              localStorage.setItem("Username", data.Username);
              localStorage.setItem("Password", data.Password);
              localStorage.setItem("Nama", data.Nama);
              localStorage.setItem("Telepon", data.Telepon);
              localStorage.setItem("Alamat", data.Alamat);
              localStorage.setItem("Foto", data.Foto);
              if(statusEl) statusEl.innerText = "Profil berhasil diperbarui.";
              setTimeout(() => {
                  showView("main-view");
              }, 1000);
          }).catch(() => {
              if(statusEl) statusEl.innerText = "Gagal memperbarui profil.";
          });
      }

      if (selectedFile) {
          const reader = new FileReader();
          reader.onload = function(evt) {
              saveData(evt.target.result);
          };
          reader.readAsDataURL(selectedFile);
      } else {
          saveData(document.getElementById("Foto").value);
      }
    }

    // --- Game App Scripts (as provided) ---
    const localUser = {
      Username: localStorage.getItem("Username"),
      Perak: parseInt(localStorage.getItem("Perak")) || 0,
    };

    if (localUser.Username) {
        const userRef = db.ref(`users/${localUser.Username}`);
        userRef.on('value', (snapshot) => {
            const userData = snapshot.val();
            if (userData !== null) {
                localUser.Perak = userData.Perak || 0;
                localStorage.setItem("Perak", localUser.Perak);
                updatePerakDisplay();
            }
        });
    }

    const ROLL_PER_REEL = 10;
    const REEL_RADIUS = 400;
    const SPIN_DURATION = 5;
    const MANUAL_SPIN_COOLDOWN = 4 * 400;

    const WIN_MULTIPLIERS = {
      'dua': 2,
      'tiga': 3,
      'empat': 4,
      'lima': 5,
      'jackpot': 10
    };

    const WIN_PROBABILITIES = {
      'dua': 0.1,
      'tiga': 0.03,
      'empat': 0.02,
      'lima': 0.0000000000000000000000000000000000000001,
      'jackpot': 0.00000000000000000000000000000000000000000000000000001
    };

    let isSpinning = false;
    let lastManualSpinTime = 0;
    let currentmain = 0;
    let isAutomainEnabled = false;
    let playerWinStreak = 0;
    let playerLoseStreak = 0;
    const HOUSE_EDGE = 0;

    function updatePerakDisplay() {
      $('#perakBalance').text(localUser.Perak.toLocaleString('id-ID'));
    }

    function showErrorMessage(message) {
      $('#errorMessage').text(message).fadeIn().delay(3000).fadeOut();
    }

    function createROLL(ring) {
      const rollAngle = 360 / ROLL_PER_REEL;
      for (let i = 0; i < ROLL_PER_REEL; i++) {
        const roll = document.createElement('div');
        roll.className = 'roll backface-on';
        roll.style.transform = `rotateX(${rollAngle * i}deg) translateZ(${REEL_RADIUS}px)`;
        const p = document.createElement('p');
        p.textContent = i;
        roll.appendChild(p);
        ring.append(roll);
      }
    }

    function generateDua() {
      const num = Math.floor(Math.random() * 10);
      const result = [num, num];
      while (result.length < 5) {
        const uniqueNum = Math.floor(Math.random() * 10);
        if (!result.includes(uniqueNum)) {
          result.push(uniqueNum);
        }
      }
      return shuffleArray(result);
    }
    
    function generateTiga() {
      const num = Math.floor(Math.random() * 10);
      const result = [num, num, num];
      while (result.length < 5) {
        const uniqueNum = Math.floor(Math.random() * 10);
        if (!result.includes(uniqueNum)) {
          result.push(uniqueNum);
        }
      }
      return shuffleArray(result);
    }
    
    function generateEmpat() {
      const num = Math.floor(Math.random() * 10);
      const result = [num, num, num, num];
      while (result.length < 5) {
        const uniqueNum = Math.floor(Math.random() * 10);
        if (!result.includes(uniqueNum)) {
          result.push(uniqueNum);
        }
      }
      return shuffleArray(result);
    }
    
    function generateLima() {
      const num = Math.floor(Math.random() * 10);
      return [num, num, num, num, num];
    }
    
    function generateJackpot() {
      const result = [1, 2, 3, 4, 5];
      return shuffleArray(result);
    }

    function generateRandomResult() {
      const result = [];
      while (result.length < 5) {
        const num = Math.floor(Math.random() * 10);
        if (!result.includes(num)) {
          result.push(num);
        }
      }
      return result;
    }

    function shuffleArray(array) {
      for (let i = array.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [array[i], array[j]] = [array[j], array[i]];
      }
      return array;
    }
    
    function generateControlledResult() {
      let currentProbabilities = WIN_PROBABILITIES;
      const rand = Math.random();
      let cumulativeProb = 0;

      for (const type in currentProbabilities) {
          cumulativeProb += currentProbabilities[type];
          if (rand < cumulativeProb) {
              switch(type) {
                  case 'dua': return generateDua();
                  case 'tiga': return generateTiga();
                  case 'empat': return generateEmpat();
                  case 'lima': return generateLima();
                  case 'jackpot': return generateJackpot();
              }
          }
      }
      return generateRandomResult();
    }

    function checkWin(result) {
      const sortedResult = [...result].sort((a, b) => a - b).join('');
      if (sortedResult === '12345') {
        return 'jackpot';
      }
      
      const frequency = {};
      result.forEach(num => {
        frequency[num] = (frequency[num] || 0) + 1;
      });
      
      const counts = Object.values(frequency);
      const hasLima = counts.some(count => count >= 5);
      const hasEmpat = counts.some(count => count >= 4);
      const hasTiga = counts.some(count => count >= 3);
      const hasDua = counts.some(count => count >= 2);
      
      if (hasLima) {
        return 'lima';
      } else if (hasEmpat) {
        return 'empat';
      } else if (hasTiga) {
        return 'tiga';
      } else if (hasDua) {
        return 'dua';
      }
      return null;
    }

    function selectmain(amount) {
      if (amount > 0 && amount <= localUser.Perak) {
        currentmain = amount;
        $('#mainAmount').val(amount);
        $('#automainButtons button').removeClass('active');
        $(`#main${amount}`).addClass('active');
      } else if (amount === 0) {
        currentmain = 0;
        $('#mainAmount').val('');
        $('#automainButtons button').removeClass('active');
      } else {
        showErrorMessage('Saldo tidak cukup.');
      }
    }

    function startAutoSpin() {
      if (currentmain <= 0) {
        showErrorMessage('Pilih jumlah taruhan.');
        return;
      }
      isAutomainEnabled = true;
      $('#startAutoSpinButton').hide();
      $('#stopAutoSpinButton').show();
      $('#spinButton').prop('disabled', true);
      spin(false);
    }

    function stopAutoSpin() {
      isAutomainEnabled = false;
      $('#stopAutoSpinButton').hide();
      $('#startAutoSpinButton').show();
      $('#spinButton').prop('disabled', false);
    }

    function spin(isManual) {
      if (isSpinning) return;
      
      const slotAudio = document.getElementById('slotAudio');
      slotAudio.currentTime = 0;
      slotAudio.play().catch(err => console.log("Autoplay blocked:", err));
      
      if (currentmain <= 0) {
        showErrorMessage('Pilih jumlah taruhan.');
        return;
      }
      if (currentmain > localUser.Perak) {
        showErrorMessage('Saldo tidak cukup.');
        return;
      }
      
      localUser.Perak -= currentmain;
      updatePerakDisplay(); 
      db.ref(`users/${localUser.Username}/Perak`).set(localUser.Perak); 
      const winAudio = document.getElementById('winAudio');
      if (!winAudio.paused) {
        winAudio.pause();
        winAudio.currentTime = 0; 
      }
      
      isSpinning = true;
      
      $('#mainResult').addClass('result-hidden');
      
      if (isManual) {
        lastManualSpinTime = Date.now();
        $('#spinButton').prop('disabled', true);
        updateManualSpinButton();
      }
      
      $('#stage .roll p').removeClass('bling-bling');
      
      for (let i = 1; i <= 5; i++) {
        $(`#ring${i}`).css('animation', `back-spin 1s`);
      }
      
      setTimeout(() => {
        const result = generateControlledResult();
        
        for (let i = 1; i <= 5; i++) {
          const seed = result[i-1];
          $(`#ring${i}`)
            .css('animation', `spin-${seed} ${SPIN_DURATION}s cubic-bezier(0.1, 0.7, 0.1, 1)`)
            .attr('class', `ring spin-${seed}`);
        }
        
        setTimeout(() => {
          for (let i = 0; i < result.length; i++) {
            const numberElement = $(`#ring${i+1} .roll`).eq(result[i]).find('p');
            numberElement.addClass('bling-bling');
          }
          
          processmainResult(result, isManual);
          
          isSpinning = false;
          
          if (isAutomainEnabled) {
            setTimeout(() => {
              if (isAutomainEnabled) {
                spin(false);
              }
            }, 3000);
          }
        }, SPIN_DURATION * 1000);
      }, 1000);
    }

    function processmainResult(result) {
      const winType = checkWin(result);
      let message = "coba lagi";
      let messageClass = "lose";
      let winAmount = 0;

      if (winType) {
        playerWinStreak++;
        playerLoseStreak = 0;
        
        const baseMultiplier = WIN_MULTIPLIERS[winType];
        const totalMultiplier = baseMultiplier * (1 - HOUSE_EDGE);
        winAmount = Math.round(currentmain * totalMultiplier);

        message = `Selamat Anda MENDAPATKAN +${winAmount.toLocaleString('id-ID')} `;
        messageClass = "win";           
        triggerConfetti(); 
        document.getElementById('winAudio').play();
      } else {
        playerWinStreak = 0;
        playerLoseStreak++;
      }

      localUser.Perak += winAmount;
      
      db.ref(`users/${localUser.Username}`).transaction((currentData) => {
        if (currentData) {
          let finalPerak = (currentData.Perak || 0) + winAmount;
          return {
            ...currentData,
            Perak: finalPerak,
          };
        } else {
          return;
        }
      }).then(() => {
        updatePerakDisplay();
        
        $('#mainResult')
          .text(message)
          .removeClass('result-hidden')
          .addClass(messageClass);
      }).catch(error => {
        console.error("Transaksi gagal:", error);
      });
    }

    function updateManualSpinButton() {
      const now = Date.now();
      const timeSinceLastSpin = now - lastManualSpinTime;
      const remainingCooldown = Math.max(0, MANUAL_SPIN_COOLDOWN - timeSinceLastSpin);
      
      if (remainingCooldown <= 0) {
        $('#spinButton').prop('disabled', false).text('Putar');
      } else {
        setTimeout(updateManualSpinButton, 1000);
      }
    }

    function triggerConfetti() {
      const defaults = {
          spread: 360,
          ticks: 200,
          gravity: 0.4,
          decay: 0.94,
          startVelocity: 90,
          colors: ['#FFC107', '#E91E63', '#4CAF50', '#2196F3']
      };
      function shoot() {
          confetti({
              ...defaults,
              particleCount: 2000,
              scalar: 1.2,
              shapes: ['star']
          });
          confetti({
              ...defaults,
              particleCount: 300,
              scalar: 0.8,
              shapes: ['circle']
          });
      }
      setTimeout(shoot, 0);
      setTimeout(shoot, 150);
      setTimeout(shoot, 300);
    }
    
    function showCustomAlert(message, type = 'info') {
      const alertDiv = document.getElementById('customAlert');
      const alertMessage = document.getElementById('alertMessage');
      const alertIcon = document.getElementById('alertIcon');
        
      alertMessage.textContent = message;
      switch(type) {
          case 'success':
              alertIcon.textContent = '';
              alertDiv.style.border = '2px solid #4CAF50';
              break;
          case 'error':
              alertIcon.textContent = '❌';
              alertDiv.style.border = '2px solid #f44336';
              break;
          case 'warning':
              alertIcon.textContent = '⚠️';
              alertDiv.style.border = '2px solid #FFC107';
              break;
          default:
              alertIcon.textContent = 'ℹ️';
              alertDiv.style.border = '2px solid #2196F3';
      }
         
      alertDiv.style.display = 'block';  
      const overlay = document.createElement('div');
      overlay.style.position = 'fixed';
      overlay.style.top = '0';
      overlay.style.left = '0';
      overlay.style.width = '100%';
      overlay.style.height = '100%';
      overlay.style.background = 'rgba(0,0,0,0.5)';
      overlay.style.zIndex = '1000';
      overlay.id = 'alertOverlay';
      document.body.appendChild(overlay);
      document.getElementById('alertOkBtn').onclick = function() {
          alertDiv.style.display = 'none';
          document.getElementById('alertOverlay').remove();
      };
    }

    function setupBurungGame() {
      const selesai = document.getElementById("selesai");
      const totalPerakSpan = document.getElementById("total-perak");
      let totalPerak = 0;
      
      const inputs = document.querySelectorAll('.input-circle');
      inputs.forEach(input => {
          input.addEventListener('change', () => {
              if (input.checked) {
                  totalPerak++;
                  totalPerakSpan.textContent = totalPerak;
              }
          });
      });

      selesai.addEventListener("click", () => {
          if (localUser.Username && totalPerak > 0) {
              const usersRef = db.ref('users');
              usersRef.orderByChild('Username').equalTo(localUser.Username).once('value')
              .then(snapshot => {
                  if (snapshot.exists()) {
                      snapshot.forEach(childSnapshot => {
                          const userId = childSnapshot.key;                      
                          
                          let currentPerak = childSnapshot.val().Perak ? parseInt(childSnapshot.val().Perak) : 0;
                          let newPerak = currentPerak + totalPerak;
                          
                          return db.ref('users/' + userId).update({ Perak: newPerak })
                          .then(() => {
                              showCustomAlert(` ${totalPerak} Perak berhasil diklaim!`, "success");
                              totalPerak = 0;
                              totalPerakSpan.textContent = totalPerak;
                              inputs.forEach(input => input.checked = false);
                          });
                      });
                  } else {
                      showCustomAlert("Pengguna tidak ditemukan.", "error");
                  }
              })
              .catch(error => {
                  console.error("Gagal mengirim perak:", error);
                  showCustomAlert("Gagal mengirim perak. Silakan coba lagi.", "error");
              });
          } else {
              showCustomAlert("Tidak ada perak yang di klaim", "info");
          }
      });
    }

    function setupInvestorForm() {
      const form = document.getElementById('topupForm');
      const statusMessage = document.getElementById('statusMessage');
      const SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbxpOktAYKx2f4hOLaTcwynZO8EghJYKpwGgMO39dr10tYZzgoUsdaLsWbjyi6AvOYiR_A/exec';
      const fileInput = document.getElementById('bukti');
      const fileNameSpan = document.getElementById('file-name');
      const transactionReceipt = document.getElementById('transactionReceipt');
      const receiptDetails = document.getElementById('receiptDetails');

      fileInput.addEventListener('change', () => {
        if (fileInput.files.length > 0) {
          fileNameSpan.textContent = fileInput.files[0].name;
          fileNameSpan.style.display = 'inline';
        } else {
          fileNameSpan.textContent = '';
          fileNameSpan.style.display = 'none';
        }
      });

      form.addEventListener('submit', async (e) => {
        e.preventDefault();
        statusMessage.textContent = 'Loading...';
        statusMessage.className = '';

        const formData = new FormData(form);
        const buktiFile = formData.get('bukti');

        if (!buktiFile || buktiFile.size === 0) {
          statusMessage.textContent = 'Harap lampirkan bukti foto.';
          statusMessage.className = 'error';
          return;
        }

        const reader = new FileReader();
        reader.readAsDataURL(buktiFile);
        
        reader.onload = async () => {
          const base64Image = reader.result.split(',')[1];
          
          const payload = {
            action: 'handleTopup',
            id: formData.get('id'),
            nama: formData.get('nama'),
            username: formData.get('username'),
            deposit: formData.get('deposit'),
            bukti: base64Image
          };

          try {
            const response = await fetch(SCRIPT_URL, {
              method: 'POST',
              body: JSON.stringify(payload) 
            });

            const result = await response.json();
            statusMessage.textContent = result.message;
            statusMessage.className = result.status === 'success' ? 'success' : 'error';
            
            if (result.status === 'success') {
              const id = formData.get('id');
              const nama = formData.get('nama');
              const username = formData.get('username');
              const deposit = formData.get('deposit');
              const now = new Date();
              const formattedDate = now.toLocaleDateString('id-ID', {
                year: 'numeric', month: 'long', day: 'numeric', hour: '2-digit', minute: '2-digit'
              });

              receiptDetails.innerHTML = `
                <p><strong>ID:</strong> ${id}</p>
                <p><strong>Nama:</strong> ${nama}</p>
                <p><strong>Username:</strong> ${username}</p>
                <p><strong>Jumlah:</strong> Rp. ${Number(deposit).toLocaleString('id-ID')}</p>
                <p><strong>Tanggal:</strong> ${formattedDate}</p>
              `;
              
              form.style.display = 'none';
              transactionReceipt.style.display = 'block';
            }
          } catch (error) {
            statusMessage.textContent = 'Terjadi kesalahan saat mengirim permintaan.';
            statusMessage.className = 'error';
            console.error('Error:', error);
          }
        };
        reader.onerror = () => {
          statusMessage.textContent = 'Gagal membaca file bukti transfer.';
          statusMessage.className = 'error';
        };
      });

      document.addEventListener('DOMContentLoaded', () => {
        const userId = localStorage.getItem('ID');
        const userName = localStorage.getItem('Nama');
        const userUsername = localStorage.getItem('Username');
        
        if (userId) {
          document.getElementById('id').value = userId;
        }
        if (userName) {
          document.getElementById('nama').value = userName;
        }
        if (userUsername) {
          document.getElementById('username').value = userUsername;
        }
      });
    }
    
    function showLogin() {
  showView('login-view');
  document.getElementById('signupBox').style.display = 'none';
  document.getElementById('loginBox').style.display = 'block';
}

function showSignup() {
  document.getElementById('loginBox').style.display = 'none';
  document.getElementById('signupBox').style.display = 'block';
}

function login() {
  const username = document.getElementById("loginUsername").value.trim();
  const password = document.getElementById("loginPassword").value.trim();
  const errorDiv = document.getElementById("errorLogin");
  const button = document.querySelector("#loginBox button");
  errorDiv.textContent = "";

  if (!username || !password) {
    errorDiv.textContent = "Nama pengguna dan password wajib diisi.";
    return;
  }

  button.disabled = true;
  button.textContent = "Tunggu sebentar ...";

  db.ref("users/" + username).once("value").then(snap => {
    if (!snap.exists()) {
      errorDiv.textContent = "Akun tidak ditemukan.";
      button.disabled = false;
      button.textContent = "Masuk";
      return;
    }

    const val = snap.val();
    if (val.Password !== password) {
      errorDiv.textContent = "Password salah.";
      button.disabled = false;
      button.textContent = "Masuk";
      return;
    }

    // simpan data ke localStorage
    localStorage.setItem("ID", val.ID);        
    localStorage.setItem("Nama", val.Nama); 
    localStorage.setItem("Saldo", val.Saldo);  
    localStorage.setItem("Perak", val.Perak);   
    localStorage.setItem("Telepon", val.Telepon);    
    localStorage.setItem("Alamat", val.Alamat);          
    localStorage.setItem("Username", val.Username);
    localStorage.setItem("Foto", val.Foto || "https://nasukafoods.site/gambarkosong.jpg");

    db.ref('posts')
      .orderByChild('Waktu')
      .limitToLast(10)
      .once('value')
      .then(snapshot => {
        const posts = [];
        snapshot.forEach(child => {
          posts.push(child.val());
        });
        posts.sort((a, b) => b.Waktu - a.Waktu);
        localStorage.setItem('latestPosts', JSON.stringify(posts));
        showView('main-view'); // arahkan balik ke beranda SPA
      });
  }).catch(() => {
    errorDiv.textContent = "Terjadi kesalahan, coba lagi.";
    button.disabled = false;
    button.textContent = "Masuk";
  });
}

function signup() {
  const n = document.getElementById('signupNama').value.trim();
  const u = document.getElementById('signupUsername').value.trim();
  const p = document.getElementById('signupPassword').value.trim();
  const errorDiv = document.getElementById("errorSignup");
  errorDiv.textContent = "";

  if (!n || !u || !p) {
    errorDiv.textContent = 'Isi semua kolom';
    return;
  }

  const ref = db.ref('users/' + u);
  ref.get().then(snap => {
    if (snap.exists()) {
      errorDiv.textContent = 'Username sudah digunakan';
      return;
    }
    const id = 'N-' + Date.now();
    const ft = 'https://nasukafoods.site/gambarkosong.jpg';
    const tp = '0859109819017';
    const al = 'Jl Nasuka No69';       
    const ii = '100';
    const oo = '10';
    const jn = 'Pria';       
    const st = 'VIP';

    ref.set({
      ID: id,
      Username: u,
      Password: p,
      Nama: n,
      NamaLower: n.toLowerCase(), 
      Foto: ft,
      Telepon: tp,
      Alamat: al,
      Jenis: jn,
      Status: st,       
      Rank: oo,          
      Saldo: oo,
      Perak: ii,
    }).then(() => {
      localStorage.setItem('Nama', n);
      localStorage.setItem('ID', id);
      localStorage.setItem('Username', u);
      localStorage.setItem('Perak', ii);
      localStorage.setItem('Saldo', oo);
      localStorage.setItem('Telepon', tp);

      showView('main-view'); // kembali ke beranda setelah daftar
    }).catch(() => {
      errorDiv.textContent = "Gagal membuat akun, coba lagi.";
    });
  }).catch(() => {
    errorDiv.textContent = "Terjadi kesalahan jaringan, coba lagi.";
  });
}
    
    
    
    

  </script>
</body>
</html>
