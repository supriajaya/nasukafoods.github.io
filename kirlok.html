<!DOCTYPE html>
<html>
<head>
    <title>Kirim Lokasi ke Firebase</title>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
</head>
<body>

    <h1>Kirim Lokasi ke Database</h1>
    <p>Klik tombol di bawah ini untuk mengirim lokasi Anda ke Firebase.</p>
    <button id="sendLocationButton">Kirim Lokasi</button>
    <p id="statusMessage"></p>

    <script>
        // Masukkan firebaseConfig Anda di sini
        const firebaseConfig = {
            apiKey: "AIzaSyAJPoqA190LutHQ7xnvnV96GTRHzz24IpI",
            authDomain: "nasukafoods1.firebaseapp.com",
            databaseURL: "https://nasukafoods1-default-rtdb.asia-southeast1.firebasedatabase.app",
            projectId: "nasukafoods1",
            messagingSenderId: "84287800896",
            appId: "1:84287800896:web:83189d6766997b00f701a5"
        };

        // Inisialisasi Firebase
        firebase.initializeApp(firebaseConfig);
        const database = firebase.database();

        // Dapatkan referensi ke elemen HTML
        const sendLocationButton = document.getElementById('sendLocationButton');
        const statusMessage = document.getElementById('statusMessage');

        // Tambahkan event listener untuk tombol
        sendLocationButton.addEventListener('click', () => {
            statusMessage.textContent = 'Mendapatkan lokasi...';

            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(
                    (position) => {
                        const { latitude, longitude } = position.coords;
                        const timestamp = new Date().toLocaleString();

                        // Buat data lokasi
                        const locationData = {
                            latitude: latitude,
                            longitude: longitude,
                            timestamp: timestamp
                        };

                        // Dapatkan referensi ke node 'locations' dan tambahkan ID 'nasukafoods'
                        const nasukafoodsRef = database.ref('locations/nasukafoods');

                        // Kirim data ke Firebase menggunakan metode `set` untuk menimpa data yang ada
                        nasukafoodsRef.set(locationData)
                            .then(() => {
                                statusMessage.textContent = '✅ Lokasi berhasil diperbarui!';
                                console.log('Lokasi berhasil diperbarui:', locationData);
                            })
                            .catch((error) => {
                                statusMessage.textContent = '❌ Gagal mengirim lokasi.';
                                console.error('Error saat mengirim lokasi:', error);
                            });

                    },
                    (error) => {
                        // Tangani error jika pengguna menolak atau ada masalah
                        statusMessage.textContent = '❌ Gagal mendapatkan lokasi. Pastikan Anda mengizinkan akses lokasi.';
                        console.error('Error saat mendapatkan lokasi:', error);
                    }
                );
            } else {
                // Browser tidak mendukung Geolocation
                statusMessage.textContent = '❌ Browser Anda tidak mendukung Geolocation API.';
            }
        });
    </script>

</body>
</html>
