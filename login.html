<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Login Nasuka</title>
  <style>
    body { font-family: sans-serif; background: #f2f2f2; padding: 2rem; }
    .box { max-width: 400px; margin: auto; padding: 2rem; background: white; border-radius: 12px; box-shadow: 0 0 10px rgba(0,0,0,0.2); }
    input, button { width: 100%; padding: 10px; margin: 8px 0; border-radius: 6px; border: 1px solid #ccc; }
    button { background: #3498db; color: white; font-weight: bold; cursor: pointer; }
    button:hover { background: #2980b9; }
  </style>
</head>
<body>
  <div class="box">
    <h2>Login Akun Nasuka</h2>
    <form id="loginForm">
      <input type="text" id="username" placeholder="Username" required />
      <input type="password" id="password" placeholder="Password" required />
      <button type="submit">Login</button>
    </form>
  </div>
  <script>
    const URL = "https://script.google.com/macros/s/AKfycbwL9L9lI4GViVClRwcGN4dg2iyqhN_bPGnuwFL5v1Q_UMp5uZqdbQJmy9LIYwG81Dqy/exec";
    document.getElementById("loginForm").addEventListener("submit", async e => {
      e.preventDefault();
      const username = document.getElementById("username").value.trim();
      const password = document.getElementById("password").value.trim();
      const form = new FormData();
      form.append("action", "login");
      form.append("username", username);
      form.append("password", password);
      try {
        const res = await fetch(URL, { method: "POST", body: form });
        const data = await res.json();
        if (data.login === "success") {
          // Simpan data ke localStorage
          localStorage.setItem("user_id", data.ID || "");
          localStorage.setItem("status", data.Status || "");
          localStorage.setItem("foto", data.Foto || "");
          localStorage.setItem("nama", data.Nama || "");
          localStorage.setItem("alamat", data.Alamat || "");
          localStorage.setItem("telepon", data.Telepon || "");
          localStorage.setItem("sosial_media", data["Sosial Media"] || "");
          localStorage.setItem("username", data.Username || "");
          localStorage.setItem("saldo", data.Saldo || "0");
          localStorage.setItem("bunga", data.Bunga || "");
          localStorage.setItem("bunga_rupiah", data["Bunga Rupiah"] || "");
          localStorage.setItem("poin", data.Poin || "0");
          localStorage.setItem("tanggal_daftar", data["Tanggal Daftar"] || "");
          // Update status online
          const formStatus = new FormData();
          formStatus.append("action", "updateProfil");
          formStatus.append("id", data.ID);
          formStatus.append("status", "ONLINE");
          fetch(URL, { method: "POST", body: formStatus });
          // Redirect ke profil-vip.html
          window.location.href = "profil-vip.html";
        } else {
          alert("Login gagal: " + (data.message || "Username atau Password salah"));
        }
      } catch (err) {
        alert("Terjadi kesalahan: " + err.message);
      }
    });
  </script>
</body>
</html>
